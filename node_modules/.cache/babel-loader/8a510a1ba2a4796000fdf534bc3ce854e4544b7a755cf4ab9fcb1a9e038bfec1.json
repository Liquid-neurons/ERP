{"ast":null,"code":"import { __extends } from \"tslib\";\nimport PDFString from \"../objects/PDFString\";\nimport PDFHexString from \"../objects/PDFHexString\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFAcroTerminal from \"./PDFAcroTerminal\";\nimport { IndexOutOfBoundsError } from \"../errors\";\nvar PDFAcroButton = /** @class */function (_super) {\n  __extends(PDFAcroButton, _super);\n  function PDFAcroButton() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  PDFAcroButton.prototype.Opt = function () {\n    return this.dict.lookupMaybe(PDFName.of('Opt'), PDFString, PDFHexString, PDFArray);\n  };\n  PDFAcroButton.prototype.setOpt = function (opt) {\n    this.dict.set(PDFName.of('Opt'), this.dict.context.obj(opt));\n  };\n  PDFAcroButton.prototype.getExportValues = function () {\n    var opt = this.Opt();\n    if (!opt) return undefined;\n    if (opt instanceof PDFString || opt instanceof PDFHexString) {\n      return [opt];\n    }\n    var values = [];\n    for (var idx = 0, len = opt.size(); idx < len; idx++) {\n      var value = opt.lookup(idx);\n      if (value instanceof PDFString || value instanceof PDFHexString) {\n        values.push(value);\n      }\n    }\n    return values;\n  };\n  PDFAcroButton.prototype.removeExportValue = function (idx) {\n    var opt = this.Opt();\n    if (!opt) return;\n    if (opt instanceof PDFString || opt instanceof PDFHexString) {\n      if (idx !== 0) throw new IndexOutOfBoundsError(idx, 0, 0);\n      this.setOpt([]);\n    } else {\n      if (idx < 0 || idx > opt.size()) {\n        throw new IndexOutOfBoundsError(idx, 0, opt.size());\n      }\n      opt.remove(idx);\n    }\n  };\n  // Enforce use use of /Opt even if it isn't strictly necessary\n  PDFAcroButton.prototype.normalizeExportValues = function () {\n    var _a, _b, _c, _d;\n    var exportValues = (_a = this.getExportValues()) !== null && _a !== void 0 ? _a : [];\n    var Opt = [];\n    var widgets = this.getWidgets();\n    for (var idx = 0, len = widgets.length; idx < len; idx++) {\n      var widget = widgets[idx];\n      var exportVal = (_b = exportValues[idx]) !== null && _b !== void 0 ? _b : PDFHexString.fromText((_d = (_c = widget.getOnValue()) === null || _c === void 0 ? void 0 : _c.decodeText()) !== null && _d !== void 0 ? _d : '');\n      Opt.push(exportVal);\n    }\n    this.setOpt(Opt);\n  };\n  /**\n   * Reuses existing opt if one exists with the same value (assuming\n   * `useExistingIdx` is `true`). Returns index of existing (or new) opt.\n   */\n  PDFAcroButton.prototype.addOpt = function (opt, useExistingOptIdx) {\n    var _a;\n    this.normalizeExportValues();\n    var optText = opt.decodeText();\n    var existingIdx;\n    if (useExistingOptIdx) {\n      var exportValues = (_a = this.getExportValues()) !== null && _a !== void 0 ? _a : [];\n      for (var idx = 0, len = exportValues.length; idx < len; idx++) {\n        var exportVal = exportValues[idx];\n        if (exportVal.decodeText() === optText) existingIdx = idx;\n      }\n    }\n    var Opt = this.Opt();\n    Opt.push(opt);\n    return existingIdx !== null && existingIdx !== void 0 ? existingIdx : Opt.size() - 1;\n  };\n  PDFAcroButton.prototype.addWidgetWithOpt = function (widget, opt, useExistingOptIdx) {\n    var optIdx = this.addOpt(opt, useExistingOptIdx);\n    var apStateValue = PDFName.of(String(optIdx));\n    this.addWidget(widget);\n    return apStateValue;\n  };\n  return PDFAcroButton;\n}(PDFAcroTerminal);\nexport default PDFAcroButton;","map":{"version":3,"names":["PDFString","PDFHexString","PDFArray","PDFName","PDFAcroTerminal","IndexOutOfBoundsError","PDFAcroButton","_super","__extends","prototype","Opt","dict","lookupMaybe","of","setOpt","opt","set","context","obj","getExportValues","undefined","values","idx","len","size","value","lookup","push","removeExportValue","remove","normalizeExportValues","exportValues","_a","widgets","getWidgets","length","widget","exportVal","_b","fromText","_d","_c","getOnValue","decodeText","addOpt","useExistingOptIdx","optText","existingIdx","addWidgetWithOpt","optIdx","apStateValue","String","addWidget"],"sources":["/Users/casarulez/Projects/Liquid-neurons/database_forms/data_entry_forms/node_modules/pdf-lib/src/core/acroform/PDFAcroButton.ts"],"sourcesContent":["import PDFObject from 'src/core/objects/PDFObject';\nimport PDFString from 'src/core/objects/PDFString';\nimport PDFHexString from 'src/core/objects/PDFHexString';\nimport PDFArray from 'src/core/objects/PDFArray';\nimport PDFName from 'src/core/objects/PDFName';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport PDFAcroTerminal from 'src/core/acroform/PDFAcroTerminal';\nimport { IndexOutOfBoundsError } from 'src/core/errors';\n\nclass PDFAcroButton extends PDFAcroTerminal {\n  Opt(): PDFString | PDFHexString | PDFArray | undefined {\n    return this.dict.lookupMaybe(\n      PDFName.of('Opt'),\n      PDFString,\n      PDFHexString,\n      PDFArray,\n    );\n  }\n\n  setOpt(opt: PDFObject[]) {\n    this.dict.set(PDFName.of('Opt'), this.dict.context.obj(opt));\n  }\n\n  getExportValues(): (PDFString | PDFHexString)[] | undefined {\n    const opt = this.Opt();\n\n    if (!opt) return undefined;\n\n    if (opt instanceof PDFString || opt instanceof PDFHexString) {\n      return [opt];\n    }\n\n    const values: (PDFString | PDFHexString)[] = [];\n    for (let idx = 0, len = opt.size(); idx < len; idx++) {\n      const value = opt.lookup(idx);\n      if (value instanceof PDFString || value instanceof PDFHexString) {\n        values.push(value);\n      }\n    }\n\n    return values;\n  }\n\n  removeExportValue(idx: number) {\n    const opt = this.Opt();\n\n    if (!opt) return;\n\n    if (opt instanceof PDFString || opt instanceof PDFHexString) {\n      if (idx !== 0) throw new IndexOutOfBoundsError(idx, 0, 0);\n      this.setOpt([]);\n    } else {\n      if (idx < 0 || idx > opt.size()) {\n        throw new IndexOutOfBoundsError(idx, 0, opt.size());\n      }\n      opt.remove(idx);\n    }\n  }\n\n  // Enforce use use of /Opt even if it isn't strictly necessary\n  normalizeExportValues() {\n    const exportValues = this.getExportValues() ?? [];\n\n    const Opt: (PDFString | PDFHexString)[] = [];\n\n    const widgets = this.getWidgets();\n    for (let idx = 0, len = widgets.length; idx < len; idx++) {\n      const widget = widgets[idx];\n      const exportVal =\n        exportValues[idx] ??\n        PDFHexString.fromText(widget.getOnValue()?.decodeText() ?? '');\n      Opt.push(exportVal);\n    }\n\n    this.setOpt(Opt);\n  }\n\n  /**\n   * Reuses existing opt if one exists with the same value (assuming\n   * `useExistingIdx` is `true`). Returns index of existing (or new) opt.\n   */\n  addOpt(opt: PDFHexString | PDFString, useExistingOptIdx: boolean): number {\n    this.normalizeExportValues();\n\n    const optText = opt.decodeText();\n\n    let existingIdx: number | undefined;\n    if (useExistingOptIdx) {\n      const exportValues = this.getExportValues() ?? [];\n      for (let idx = 0, len = exportValues.length; idx < len; idx++) {\n        const exportVal = exportValues[idx];\n        if (exportVal.decodeText() === optText) existingIdx = idx;\n      }\n    }\n\n    const Opt = this.Opt() as PDFArray;\n    Opt.push(opt);\n\n    return existingIdx ?? Opt.size() - 1;\n  }\n\n  addWidgetWithOpt(\n    widget: PDFRef,\n    opt: PDFHexString | PDFString,\n    useExistingOptIdx: boolean,\n  ) {\n    const optIdx = this.addOpt(opt, useExistingOptIdx);\n    const apStateValue = PDFName.of(String(optIdx));\n    this.addWidget(widget);\n    return apStateValue;\n  }\n}\n\nexport default PDFAcroButton;\n"],"mappings":";AACA,OAAOA,SAAS;AAChB,OAAOC,YAAY;AACnB,OAAOC,QAAQ;AACf,OAAOC,OAAO;AAEd,OAAOC,eAAe;AACtB,SAASC,qBAAqB,QAAE;AAEhC,IAAAC,aAAA,0BAAAC,MAAA;EAA4BC,SAAA,CAAAF,aAAA,EAAAC,MAAA;EAA5B,SAAAD,cAAA;;EAsGA;EArGEA,aAAA,CAAAG,SAAA,CAAAC,GAAG,GAAH;IACE,OAAO,IAAI,CAACC,IAAI,CAACC,WAAW,CAC1BT,OAAO,CAACU,EAAE,CAAC,KAAK,CAAC,EACjBb,SAAS,EACTC,YAAY,EACZC,QAAQ,CACT;EACH,CAAC;EAEDI,aAAA,CAAAG,SAAA,CAAAK,MAAM,GAAN,UAAOC,GAAgB;IACrB,IAAI,CAACJ,IAAI,CAACK,GAAG,CAACb,OAAO,CAACU,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,CAACF,IAAI,CAACM,OAAO,CAACC,GAAG,CAACH,GAAG,CAAC,CAAC;EAC9D,CAAC;EAEDT,aAAA,CAAAG,SAAA,CAAAU,eAAe,GAAf;IACE,IAAMJ,GAAG,GAAG,IAAI,CAACL,GAAG,EAAE;IAEtB,IAAI,CAACK,GAAG,EAAE,OAAOK,SAAS;IAE1B,IAAIL,GAAG,YAAYf,SAAS,IAAIe,GAAG,YAAYd,YAAY,EAAE;MAC3D,OAAO,CAACc,GAAG,CAAC;;IAGd,IAAMM,MAAM,GAAiC,EAAE;IAC/C,KAAK,IAAIC,GAAG,GAAG,CAAC,EAAEC,GAAG,GAAGR,GAAG,CAACS,IAAI,EAAE,EAAEF,GAAG,GAAGC,GAAG,EAAED,GAAG,EAAE,EAAE;MACpD,IAAMG,KAAK,GAAGV,GAAG,CAACW,MAAM,CAACJ,GAAG,CAAC;MAC7B,IAAIG,KAAK,YAAYzB,SAAS,IAAIyB,KAAK,YAAYxB,YAAY,EAAE;QAC/DoB,MAAM,CAACM,IAAI,CAACF,KAAK,CAAC;;;IAItB,OAAOJ,MAAM;EACf,CAAC;EAEDf,aAAA,CAAAG,SAAA,CAAAmB,iBAAiB,GAAjB,UAAkBN,GAAW;IAC3B,IAAMP,GAAG,GAAG,IAAI,CAACL,GAAG,EAAE;IAEtB,IAAI,CAACK,GAAG,EAAE;IAEV,IAAIA,GAAG,YAAYf,SAAS,IAAIe,GAAG,YAAYd,YAAY,EAAE;MAC3D,IAAIqB,GAAG,KAAK,CAAC,EAAE,MAAM,IAAIjB,qBAAqB,CAACiB,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;MACzD,IAAI,CAACR,MAAM,CAAC,EAAE,CAAC;KAChB,MAAM;MACL,IAAIQ,GAAG,GAAG,CAAC,IAAIA,GAAG,GAAGP,GAAG,CAACS,IAAI,EAAE,EAAE;QAC/B,MAAM,IAAInB,qBAAqB,CAACiB,GAAG,EAAE,CAAC,EAAEP,GAAG,CAACS,IAAI,EAAE,CAAC;;MAErDT,GAAG,CAACc,MAAM,CAACP,GAAG,CAAC;;EAEnB,CAAC;EAED;EACAhB,aAAA,CAAAG,SAAA,CAAAqB,qBAAqB,GAArB;;IACE,IAAMC,YAAY,IAAAC,EAAA,GAAG,IAAI,CAACb,eAAe,EAAE,cAAAa,EAAA,cAAAA,EAAA,GAAI,EAAE;IAEjD,IAAMtB,GAAG,GAAiC,EAAE;IAE5C,IAAMuB,OAAO,GAAG,IAAI,CAACC,UAAU,EAAE;IACjC,KAAK,IAAIZ,GAAG,GAAG,CAAC,EAAEC,GAAG,GAAGU,OAAO,CAACE,MAAM,EAAEb,GAAG,GAAGC,GAAG,EAAED,GAAG,EAAE,EAAE;MACxD,IAAMc,MAAM,GAAGH,OAAO,CAACX,GAAG,CAAC;MAC3B,IAAMe,SAAS,IAAAC,EAAA,GACbP,YAAY,CAACT,GAAG,CAAC,cAAAgB,EAAA,cAAAA,EAAA,GACjBrC,YAAY,CAACsC,QAAQ,EAAAC,EAAA,IAAAC,EAAA,GAACL,MAAM,CAACM,UAAU,EAAE,cAAAD,EAAA,uBAAAA,EAAA,CAAEE,UAAU,gBAAAH,EAAA,cAAAA,EAAA,GAAM,EAAE,CAAC;MAChE9B,GAAG,CAACiB,IAAI,CAACU,SAAS,CAAC;;IAGrB,IAAI,CAACvB,MAAM,CAACJ,GAAG,CAAC;EAClB,CAAC;EAED;;;;EAIAJ,aAAA,CAAAG,SAAA,CAAAmC,MAAM,GAAN,UAAO7B,GAA6B,EAAE8B,iBAA0B;;IAC9D,IAAI,CAACf,qBAAqB,EAAE;IAE5B,IAAMgB,OAAO,GAAG/B,GAAG,CAAC4B,UAAU,EAAE;IAEhC,IAAII,WAA+B;IACnC,IAAIF,iBAAiB,EAAE;MACrB,IAAMd,YAAY,IAAAC,EAAA,GAAG,IAAI,CAACb,eAAe,EAAE,cAAAa,EAAA,cAAAA,EAAA,GAAI,EAAE;MACjD,KAAK,IAAIV,GAAG,GAAG,CAAC,EAAEC,GAAG,GAAGQ,YAAY,CAACI,MAAM,EAAEb,GAAG,GAAGC,GAAG,EAAED,GAAG,EAAE,EAAE;QAC7D,IAAMe,SAAS,GAAGN,YAAY,CAACT,GAAG,CAAC;QACnC,IAAIe,SAAS,CAACM,UAAU,EAAE,KAAKG,OAAO,EAAEC,WAAW,GAAGzB,GAAG;;;IAI7D,IAAMZ,GAAG,GAAG,IAAI,CAACA,GAAG,EAAc;IAClCA,GAAG,CAACiB,IAAI,CAACZ,GAAG,CAAC;IAEb,OAAOgC,WAAW,aAAXA,WAAW,cAAXA,WAAW,GAAIrC,GAAG,CAACc,IAAI,EAAE,GAAG,CAAC;EACtC,CAAC;EAEDlB,aAAA,CAAAG,SAAA,CAAAuC,gBAAgB,GAAhB,UACEZ,MAAc,EACdrB,GAA6B,EAC7B8B,iBAA0B;IAE1B,IAAMI,MAAM,GAAG,IAAI,CAACL,MAAM,CAAC7B,GAAG,EAAE8B,iBAAiB,CAAC;IAClD,IAAMK,YAAY,GAAG/C,OAAO,CAACU,EAAE,CAACsC,MAAM,CAACF,MAAM,CAAC,CAAC;IAC/C,IAAI,CAACG,SAAS,CAAChB,MAAM,CAAC;IACtB,OAAOc,YAAY;EACrB,CAAC;EACH,OAAA5C,aAAC;AAAD,CAAC,CAtG2BF,eAAe;AAwG3C,eAAeE,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}