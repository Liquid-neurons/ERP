{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar png_1 = require(\"../../utils/png\");\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/devongovett/pdfkit/blob/e71edab0dd4657b5a767804ba86c94c58d01fbca/lib/image/png.coffee\n */\nvar PngEmbedder = /** @class */function () {\n  function PngEmbedder(png) {\n    this.image = png;\n    this.bitsPerComponent = png.bitsPerComponent;\n    this.width = png.width;\n    this.height = png.height;\n    this.colorSpace = 'DeviceRGB';\n  }\n  PngEmbedder.for = function (imageData) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var png;\n      return tslib_1.__generator(this, function (_a) {\n        png = png_1.PNG.load(imageData);\n        return [2 /*return*/, new PngEmbedder(png)];\n      });\n    });\n  };\n  PngEmbedder.prototype.embedIntoContext = function (context, ref) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var SMask, xObject;\n      return tslib_1.__generator(this, function (_a) {\n        SMask = this.embedAlphaChannel(context);\n        xObject = context.flateStream(this.image.rgbChannel, {\n          Type: 'XObject',\n          Subtype: 'Image',\n          BitsPerComponent: this.image.bitsPerComponent,\n          Width: this.image.width,\n          Height: this.image.height,\n          ColorSpace: this.colorSpace,\n          SMask: SMask\n        });\n        if (ref) {\n          context.assign(ref, xObject);\n          return [2 /*return*/, ref];\n        } else {\n          return [2 /*return*/, context.register(xObject)];\n        }\n        return [2 /*return*/];\n      });\n    });\n  };\n  PngEmbedder.prototype.embedAlphaChannel = function (context) {\n    if (!this.image.alphaChannel) return undefined;\n    var xObject = context.flateStream(this.image.alphaChannel, {\n      Type: 'XObject',\n      Subtype: 'Image',\n      Height: this.image.height,\n      Width: this.image.width,\n      BitsPerComponent: this.image.bitsPerComponent,\n      ColorSpace: 'DeviceGray',\n      Decode: [0, 1]\n    });\n    return context.register(xObject);\n  };\n  return PngEmbedder;\n}();\nexports.default = PngEmbedder;","map":{"version":3,"names":["png_1","require","PngEmbedder","png","image","bitsPerComponent","width","height","colorSpace","for","imageData","PNG","load","prototype","embedIntoContext","context","ref","SMask","embedAlphaChannel","xObject","flateStream","rgbChannel","Type","Subtype","BitsPerComponent","Width","Height","ColorSpace","assign","register","alphaChannel","undefined","Decode","exports","default"],"sources":["/Users/casarulez/Projects/Liquid-neurons/database_forms/data_entry_forms/node_modules/pdf-lib/src/core/embedders/PngEmbedder.ts"],"sourcesContent":["import PDFRef from 'src/core/objects/PDFRef';\nimport PDFContext from 'src/core/PDFContext';\nimport { PNG } from 'src/utils/png';\n\n/**\n * A note of thanks to the developers of https://github.com/foliojs/pdfkit, as\n * this class borrows from:\n *   https://github.com/devongovett/pdfkit/blob/e71edab0dd4657b5a767804ba86c94c58d01fbca/lib/image/png.coffee\n */\nclass PngEmbedder {\n  static async for(imageData: Uint8Array) {\n    const png = PNG.load(imageData);\n    return new PngEmbedder(png);\n  }\n\n  readonly bitsPerComponent: number;\n  readonly height: number;\n  readonly width: number;\n  readonly colorSpace: 'DeviceRGB';\n\n  private readonly image: PNG;\n\n  private constructor(png: PNG) {\n    this.image = png;\n    this.bitsPerComponent = png.bitsPerComponent;\n    this.width = png.width;\n    this.height = png.height;\n    this.colorSpace = 'DeviceRGB';\n  }\n\n  async embedIntoContext(context: PDFContext, ref?: PDFRef): Promise<PDFRef> {\n    const SMask = this.embedAlphaChannel(context);\n\n    const xObject = context.flateStream(this.image.rgbChannel, {\n      Type: 'XObject',\n      Subtype: 'Image',\n      BitsPerComponent: this.image.bitsPerComponent,\n      Width: this.image.width,\n      Height: this.image.height,\n      ColorSpace: this.colorSpace,\n      SMask,\n    });\n\n    if (ref) {\n      context.assign(ref, xObject);\n      return ref;\n    } else {\n      return context.register(xObject);\n    }\n  }\n\n  private embedAlphaChannel(context: PDFContext): PDFRef | undefined {\n    if (!this.image.alphaChannel) return undefined;\n\n    const xObject = context.flateStream(this.image.alphaChannel, {\n      Type: 'XObject',\n      Subtype: 'Image',\n      Height: this.image.height,\n      Width: this.image.width,\n      BitsPerComponent: this.image.bitsPerComponent,\n      ColorSpace: 'DeviceGray',\n      Decode: [0, 1],\n    });\n\n    return context.register(xObject);\n  }\n}\n\nexport default PngEmbedder;\n"],"mappings":";;;;;;AAEA,IAAAA,KAAA,GAAAC,OAAA;AAEA;;;;;AAKA,IAAAC,WAAA;EAaE,SAAAA,YAAoBC,GAAQ;IAC1B,IAAI,CAACC,KAAK,GAAGD,GAAG;IAChB,IAAI,CAACE,gBAAgB,GAAGF,GAAG,CAACE,gBAAgB;IAC5C,IAAI,CAACC,KAAK,GAAGH,GAAG,CAACG,KAAK;IACtB,IAAI,CAACC,MAAM,GAAGJ,GAAG,CAACI,MAAM;IACxB,IAAI,CAACC,UAAU,GAAG,WAAW;EAC/B;EAlBaN,WAAA,CAAAO,GAAG,GAAhB,UAAiBC,SAAqB;;;;QAC9BP,GAAG,GAAGH,KAAA,CAAAW,GAAG,CAACC,IAAI,CAACF,SAAS,CAAC;QAC/B,sBAAO,IAAIR,WAAW,CAACC,GAAG,CAAC;;;GAC5B;EAiBKD,WAAA,CAAAW,SAAA,CAAAC,gBAAgB,GAAtB,UAAuBC,OAAmB,EAAEC,GAAY;;;;QAChDC,KAAK,GAAG,IAAI,CAACC,iBAAiB,CAACH,OAAO,CAAC;QAEvCI,OAAO,GAAGJ,OAAO,CAACK,WAAW,CAAC,IAAI,CAAChB,KAAK,CAACiB,UAAU,EAAE;UACzDC,IAAI,EAAE,SAAS;UACfC,OAAO,EAAE,OAAO;UAChBC,gBAAgB,EAAE,IAAI,CAACpB,KAAK,CAACC,gBAAgB;UAC7CoB,KAAK,EAAE,IAAI,CAACrB,KAAK,CAACE,KAAK;UACvBoB,MAAM,EAAE,IAAI,CAACtB,KAAK,CAACG,MAAM;UACzBoB,UAAU,EAAE,IAAI,CAACnB,UAAU;UAC3BS,KAAK,EAAAA;SACN,CAAC;QAEF,IAAID,GAAG,EAAE;UACPD,OAAO,CAACa,MAAM,CAACZ,GAAG,EAAEG,OAAO,CAAC;UAC5B,sBAAOH,GAAG;SACX,MAAM;UACL,sBAAOD,OAAO,CAACc,QAAQ,CAACV,OAAO,CAAC;;;;;GAEnC;EAEOjB,WAAA,CAAAW,SAAA,CAAAK,iBAAiB,GAAzB,UAA0BH,OAAmB;IAC3C,IAAI,CAAC,IAAI,CAACX,KAAK,CAAC0B,YAAY,EAAE,OAAOC,SAAS;IAE9C,IAAMZ,OAAO,GAAGJ,OAAO,CAACK,WAAW,CAAC,IAAI,CAAChB,KAAK,CAAC0B,YAAY,EAAE;MAC3DR,IAAI,EAAE,SAAS;MACfC,OAAO,EAAE,OAAO;MAChBG,MAAM,EAAE,IAAI,CAACtB,KAAK,CAACG,MAAM;MACzBkB,KAAK,EAAE,IAAI,CAACrB,KAAK,CAACE,KAAK;MACvBkB,gBAAgB,EAAE,IAAI,CAACpB,KAAK,CAACC,gBAAgB;MAC7CsB,UAAU,EAAE,YAAY;MACxBK,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC;KACd,CAAC;IAEF,OAAOjB,OAAO,CAACc,QAAQ,CAACV,OAAO,CAAC;EAClC,CAAC;EACH,OAAAjB,WAAC;AAAD,CAAC,CAzDD;AA2DA+B,OAAA,CAAAC,OAAA,GAAehC,WAAW","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}