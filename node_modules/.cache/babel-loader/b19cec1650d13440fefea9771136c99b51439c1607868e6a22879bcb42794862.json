{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar tslib_1 = require(\"tslib\");\nvar errors_1 = require(\"./errors\");\nvar PDFEmbeddedPage_1 = tslib_1.__importDefault(require(\"./PDFEmbeddedPage\"));\nvar PDFFont_1 = tslib_1.__importDefault(require(\"./PDFFont\"));\nvar PDFImage_1 = tslib_1.__importDefault(require(\"./PDFImage\"));\nvar PDFPage_1 = tslib_1.__importDefault(require(\"./PDFPage\"));\nvar PDFForm_1 = tslib_1.__importDefault(require(\"./form/PDFForm\"));\nvar sizes_1 = require(\"./sizes\");\nvar core_1 = require(\"../core\");\nvar PDFDocumentOptions_1 = require(\"./PDFDocumentOptions\");\nvar utils_1 = require(\"../utils\");\nvar FileEmbedder_1 = tslib_1.__importStar(require(\"../core/embedders/FileEmbedder\"));\nvar PDFEmbeddedFile_1 = tslib_1.__importDefault(require(\"./PDFEmbeddedFile\"));\nvar PDFJavaScript_1 = tslib_1.__importDefault(require(\"./PDFJavaScript\"));\nvar JavaScriptEmbedder_1 = tslib_1.__importDefault(require(\"../core/embedders/JavaScriptEmbedder\"));\n/**\n * Represents a PDF document.\n */\nvar PDFDocument = /** @class */function () {\n  function PDFDocument(context, ignoreEncryption, updateMetadata) {\n    var _this = this;\n    /** The default word breaks used in PDFPage.drawText */\n    this.defaultWordBreaks = [' '];\n    this.computePages = function () {\n      var pages = [];\n      _this.catalog.Pages().traverse(function (node, ref) {\n        if (node instanceof core_1.PDFPageLeaf) {\n          var page = _this.pageMap.get(node);\n          if (!page) {\n            page = PDFPage_1.default.of(node, ref, _this);\n            _this.pageMap.set(node, page);\n          }\n          pages.push(page);\n        }\n      });\n      return pages;\n    };\n    this.getOrCreateForm = function () {\n      var acroForm = _this.catalog.getOrCreateAcroForm();\n      return PDFForm_1.default.of(acroForm, _this);\n    };\n    utils_1.assertIs(context, 'context', [[core_1.PDFContext, 'PDFContext']]);\n    utils_1.assertIs(ignoreEncryption, 'ignoreEncryption', ['boolean']);\n    this.context = context;\n    this.catalog = context.lookup(context.trailerInfo.Root);\n    this.isEncrypted = !!context.lookup(context.trailerInfo.Encrypt);\n    this.pageCache = utils_1.Cache.populatedBy(this.computePages);\n    this.pageMap = new Map();\n    this.formCache = utils_1.Cache.populatedBy(this.getOrCreateForm);\n    this.fonts = [];\n    this.images = [];\n    this.embeddedPages = [];\n    this.embeddedFiles = [];\n    this.javaScripts = [];\n    if (!ignoreEncryption && this.isEncrypted) throw new errors_1.EncryptedPDFError();\n    if (updateMetadata) this.updateInfoDict();\n  }\n  /**\n   * Load an existing [[PDFDocument]]. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                               |\n   * | ------------- | ------------------------------------------------------ |\n   * | `string`      | A base64 encoded string (or data URI) containing a PDF |\n   * | `Uint8Array`  | The raw bytes of a PDF                                 |\n   * | `ArrayBuffer` | The raw bytes of a PDF                                 |\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   *\n   * // pdf=string\n   * const base64 =\n   *  'JVBERi0xLjcKJYGBgYEKCjUgMCBvYmoKPDwKL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0xlbm' +\n   *  'd0aCAxMDQKPj4Kc3RyZWFtCniccwrhMlAAwaJ0Ln2P1Jyy1JLM5ERdc0MjCwUjE4WQNC4Q' +\n   *  '6cNlCFZkqGCqYGSqEJLLZWNuYGZiZmbkYuZsZmlmZGRgZmluDCQNzc3NTM2NzdzMXMxMjQ' +\n   *  'ztFEKyuEK0uFxDuAAOERdVCmVuZHN0cmVhbQplbmRvYmoKCjYgMCBvYmoKPDwKL0ZpbHRl' +\n   *  'ciAvRmxhdGVEZWNvZGUKL1R5cGUgL09ialN0bQovTiA0Ci9GaXJzdCAyMAovTGVuZ3RoID' +\n   *  'IxNQo+PgpzdHJlYW0KeJxVj9GqwjAMhu/zFHkBzTo3nCCCiiKIHPEICuJF3cKoSCu2E8/b' +\n   *  '20wPIr1p8v9/8kVhgilmGfawX2CGaVrgcAi0/bsy0lrX7IGWpvJ4iJYEN3gEmrrGBlQwGs' +\n   *  'HHO9VBX1wNrxAqMX87RBD5xpJuddqwd82tjAHxzV1U5LPgy52DKXWnr1Lheg+j/c/pzGVr' +\n   *  'iqV0VlwZPXGPCJjElw/ybkwUmeoWgxesDXGhHJC/D/iikp1Av80ptKU0FdBEe25pPihAM1' +\n   *  'u6ytgaaWfs2Hrz35CJT1+EWmAKZW5kc3RyZWFtCmVuZG9iagoKNyAwIG9iago8PAovU2l6' +\n   *  'ZSA4Ci9Sb290IDIgMCBSCi9GaWx0ZXIgL0ZsYXRlRGVjb2RlCi9UeXBlIC9YUmVmCi9MZW' +\n   *  '5ndGggMzgKL1cgWyAxIDIgMiBdCi9JbmRleCBbIDAgOCBdCj4+CnN0cmVhbQp4nBXEwREA' +\n   *  'EBAEsCwz3vrvRmOOyyOoGhZdutHN2MT55fIAVocD+AplbmRzdHJlYW0KZW5kb2JqCgpzdG' +\n   *  'FydHhyZWYKNTEwCiUlRU9G'\n   *\n   * const dataUri = 'data:application/pdf;base64,' + base64\n   *\n   * const pdfDoc1 = await PDFDocument.load(base64)\n   * const pdfDoc2 = await PDFDocument.load(dataUri)\n   *\n   * // pdf=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('with_update_sections.pdf')\n   * const pdfDoc3 = await PDFDocument.load(uint8Array)\n   *\n   * // pdf=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/with_update_sections.pdf'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const pdfDoc4 = await PDFDocument.load(arrayBuffer)\n   *\n   * ```\n   *\n   * @param pdf The input data containing a PDF document.\n   * @param options The options to be used when loading the document.\n   * @returns Resolves with a document loaded from the input.\n   */\n  PDFDocument.load = function (pdf, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, ignoreEncryption, _b, parseSpeed, _c, throwOnInvalidObject, _d, updateMetadata, _e, capNumbers, bytes, context;\n      return tslib_1.__generator(this, function (_f) {\n        switch (_f.label) {\n          case 0:\n            _a = options.ignoreEncryption, ignoreEncryption = _a === void 0 ? false : _a, _b = options.parseSpeed, parseSpeed = _b === void 0 ? PDFDocumentOptions_1.ParseSpeeds.Slow : _b, _c = options.throwOnInvalidObject, throwOnInvalidObject = _c === void 0 ? false : _c, _d = options.updateMetadata, updateMetadata = _d === void 0 ? true : _d, _e = options.capNumbers, capNumbers = _e === void 0 ? false : _e;\n            utils_1.assertIs(pdf, 'pdf', ['string', Uint8Array, ArrayBuffer]);\n            utils_1.assertIs(ignoreEncryption, 'ignoreEncryption', ['boolean']);\n            utils_1.assertIs(parseSpeed, 'parseSpeed', ['number']);\n            utils_1.assertIs(throwOnInvalidObject, 'throwOnInvalidObject', ['boolean']);\n            bytes = utils_1.toUint8Array(pdf);\n            return [4 /*yield*/, core_1.PDFParser.forBytesWithOptions(bytes, parseSpeed, throwOnInvalidObject, capNumbers).parseDocument()];\n          case 1:\n            context = _f.sent();\n            return [2 /*return*/, new PDFDocument(context, ignoreEncryption, updateMetadata)];\n        }\n      });\n    });\n  };\n  /**\n   * Create a new [[PDFDocument]].\n   * @returns Resolves with the newly created document.\n   */\n  PDFDocument.create = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, updateMetadata, context, pageTree, pageTreeRef, catalog;\n      return tslib_1.__generator(this, function (_b) {\n        _a = options.updateMetadata, updateMetadata = _a === void 0 ? true : _a;\n        context = core_1.PDFContext.create();\n        pageTree = core_1.PDFPageTree.withContext(context);\n        pageTreeRef = context.register(pageTree);\n        catalog = core_1.PDFCatalog.withContextAndPages(context, pageTreeRef);\n        context.trailerInfo.Root = context.register(catalog);\n        return [2 /*return*/, new PDFDocument(context, false, updateMetadata)];\n      });\n    });\n  };\n  /**\n   * Register a fontkit instance. This must be done before custom fonts can\n   * be embedded. See [here](https://github.com/Hopding/pdf-lib/tree/master#fontkit-installation)\n   * for instructions on how to install and register a fontkit instance.\n   *\n   * > You do **not** need to call this method to embed standard fonts.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   * import fontkit from '@pdf-lib/fontkit'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * pdfDoc.registerFontkit(fontkit)\n   * ```\n   *\n   * @param fontkit The fontkit instance to be registered.\n   */\n  PDFDocument.prototype.registerFontkit = function (fontkit) {\n    this.fontkit = fontkit;\n  };\n  /**\n   * Get the [[PDFForm]] containing all interactive fields for this document.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const fields = form.getFields()\n   * fields.forEach(field => {\n   *   const type = field.constructor.name\n   *   const name = field.getName()\n   *   console.log(`${type}: ${name}`)\n   * })\n   * ```\n   * @returns The form for this document.\n   */\n  PDFDocument.prototype.getForm = function () {\n    var form = this.formCache.access();\n    if (form.hasXFA()) {\n      console.warn('Removing XFA form data as pdf-lib does not support reading or writing XFA');\n      form.deleteXFA();\n    }\n    return form;\n  };\n  /**\n   * Get this document's title metadata. The title appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const title = pdfDoc.getTitle()\n   * ```\n   * @returns A string containing the title of this document, if it has one.\n   */\n  PDFDocument.prototype.getTitle = function () {\n    var title = this.getInfoDict().lookup(core_1.PDFName.Title);\n    if (!title) return undefined;\n    assertIsLiteralOrHexString(title);\n    return title.decodeText();\n  };\n  /**\n   * Get this document's author metadata. The author appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const author = pdfDoc.getAuthor()\n   * ```\n   * @returns A string containing the author of this document, if it has one.\n   */\n  PDFDocument.prototype.getAuthor = function () {\n    var author = this.getInfoDict().lookup(core_1.PDFName.Author);\n    if (!author) return undefined;\n    assertIsLiteralOrHexString(author);\n    return author.decodeText();\n  };\n  /**\n   * Get this document's subject metadata. The subject appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const subject = pdfDoc.getSubject()\n   * ```\n   * @returns A string containing the subject of this document, if it has one.\n   */\n  PDFDocument.prototype.getSubject = function () {\n    var subject = this.getInfoDict().lookup(core_1.PDFName.Subject);\n    if (!subject) return undefined;\n    assertIsLiteralOrHexString(subject);\n    return subject.decodeText();\n  };\n  /**\n   * Get this document's keywords metadata. The keywords appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const keywords = pdfDoc.getKeywords()\n   * ```\n   * @returns A string containing the keywords of this document, if it has any.\n   */\n  PDFDocument.prototype.getKeywords = function () {\n    var keywords = this.getInfoDict().lookup(core_1.PDFName.Keywords);\n    if (!keywords) return undefined;\n    assertIsLiteralOrHexString(keywords);\n    return keywords.decodeText();\n  };\n  /**\n   * Get this document's creator metadata. The creator appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const creator = pdfDoc.getCreator()\n   * ```\n   * @returns A string containing the creator of this document, if it has one.\n   */\n  PDFDocument.prototype.getCreator = function () {\n    var creator = this.getInfoDict().lookup(core_1.PDFName.Creator);\n    if (!creator) return undefined;\n    assertIsLiteralOrHexString(creator);\n    return creator.decodeText();\n  };\n  /**\n   * Get this document's producer metadata. The producer appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const producer = pdfDoc.getProducer()\n   * ```\n   * @returns A string containing the producer of this document, if it has one.\n   */\n  PDFDocument.prototype.getProducer = function () {\n    var producer = this.getInfoDict().lookup(core_1.PDFName.Producer);\n    if (!producer) return undefined;\n    assertIsLiteralOrHexString(producer);\n    return producer.decodeText();\n  };\n  /**\n   * Get this document's creation date metadata. The creation date appears in\n   * the \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const creationDate = pdfDoc.getCreationDate()\n   * ```\n   * @returns A Date containing the creation date of this document,\n   *          if it has one.\n   */\n  PDFDocument.prototype.getCreationDate = function () {\n    var creationDate = this.getInfoDict().lookup(core_1.PDFName.CreationDate);\n    if (!creationDate) return undefined;\n    assertIsLiteralOrHexString(creationDate);\n    return creationDate.decodeDate();\n  };\n  /**\n   * Get this document's modification date metadata. The modification date\n   * appears in the \"Document Properties\" section of most PDF readers.\n   * For example:\n   * ```js\n   * const modification = pdfDoc.getModificationDate()\n   * ```\n   * @returns A Date containing the modification date of this document,\n   *          if it has one.\n   */\n  PDFDocument.prototype.getModificationDate = function () {\n    var modificationDate = this.getInfoDict().lookup(core_1.PDFName.ModDate);\n    if (!modificationDate) return undefined;\n    assertIsLiteralOrHexString(modificationDate);\n    return modificationDate.decodeDate();\n  };\n  /**\n   * Set this document's title metadata. The title will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setTitle('ðŸ¥š The Life of an Egg ðŸ³')\n   * ```\n   *\n   * To display the title in the window's title bar, set the\n   * `showInWindowTitleBar` option to `true` (works for _most_ PDF readers).\n   * For example:\n   * ```js\n   * pdfDoc.setTitle('ðŸ¥š The Life of an Egg ðŸ³', { showInWindowTitleBar: true })\n   * ```\n   *\n   * @param title The title of this document.\n   * @param options The options to be used when setting the title.\n   */\n  PDFDocument.prototype.setTitle = function (title, options) {\n    utils_1.assertIs(title, 'title', ['string']);\n    var key = core_1.PDFName.of('Title');\n    this.getInfoDict().set(key, core_1.PDFHexString.fromText(title));\n    // Indicate that readers should display the title rather than the filename\n    if (options === null || options === void 0 ? void 0 : options.showInWindowTitleBar) {\n      var prefs = this.catalog.getOrCreateViewerPreferences();\n      prefs.setDisplayDocTitle(true);\n    }\n  };\n  /**\n   * Set this document's author metadata. The author will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setAuthor('Humpty Dumpty')\n   * ```\n   * @param author The author of this document.\n   */\n  PDFDocument.prototype.setAuthor = function (author) {\n    utils_1.assertIs(author, 'author', ['string']);\n    var key = core_1.PDFName.of('Author');\n    this.getInfoDict().set(key, core_1.PDFHexString.fromText(author));\n  };\n  /**\n   * Set this document's subject metadata. The subject will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setSubject('ðŸ“˜ An Epic Tale of Woe ðŸ“–')\n   * ```\n   * @param subject The subject of this document.\n   */\n  PDFDocument.prototype.setSubject = function (subject) {\n    utils_1.assertIs(subject, 'author', ['string']);\n    var key = core_1.PDFName.of('Subject');\n    this.getInfoDict().set(key, core_1.PDFHexString.fromText(subject));\n  };\n  /**\n   * Set this document's keyword metadata. These keywords will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setKeywords(['eggs', 'wall', 'fall', 'king', 'horses', 'men'])\n   * ```\n   * @param keywords An array of keywords associated with this document.\n   */\n  PDFDocument.prototype.setKeywords = function (keywords) {\n    utils_1.assertIs(keywords, 'keywords', [Array]);\n    var key = core_1.PDFName.of('Keywords');\n    this.getInfoDict().set(key, core_1.PDFHexString.fromText(keywords.join(' ')));\n  };\n  /**\n   * Set this document's creator metadata. The creator will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setCreator('PDF App 9000 ðŸ¤–')\n   * ```\n   * @param creator The creator of this document.\n   */\n  PDFDocument.prototype.setCreator = function (creator) {\n    utils_1.assertIs(creator, 'creator', ['string']);\n    var key = core_1.PDFName.of('Creator');\n    this.getInfoDict().set(key, core_1.PDFHexString.fromText(creator));\n  };\n  /**\n   * Set this document's producer metadata. The producer will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setProducer('PDF App 9000 ðŸ¤–')\n   * ```\n   * @param producer The producer of this document.\n   */\n  PDFDocument.prototype.setProducer = function (producer) {\n    utils_1.assertIs(producer, 'creator', ['string']);\n    var key = core_1.PDFName.of('Producer');\n    this.getInfoDict().set(key, core_1.PDFHexString.fromText(producer));\n  };\n  /**\n   * Set this document's language metadata. The language will appear in the\n   * \"Document Properties\" section of some PDF readers. For example:\n   * ```js\n   * pdfDoc.setLanguage('en-us')\n   * ```\n   *\n   * @param language An RFC 3066 _Language-Tag_ denoting the language of this\n   *                 document, or an empty string if the language is unknown.\n   */\n  PDFDocument.prototype.setLanguage = function (language) {\n    utils_1.assertIs(language, 'language', ['string']);\n    var key = core_1.PDFName.of('Lang');\n    this.catalog.set(key, core_1.PDFString.of(language));\n  };\n  /**\n   * Set this document's creation date metadata. The creation date will appear\n   * in the \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setCreationDate(new Date())\n   * ```\n   * @param creationDate The date this document was created.\n   */\n  PDFDocument.prototype.setCreationDate = function (creationDate) {\n    utils_1.assertIs(creationDate, 'creationDate', [[Date, 'Date']]);\n    var key = core_1.PDFName.of('CreationDate');\n    this.getInfoDict().set(key, core_1.PDFString.fromDate(creationDate));\n  };\n  /**\n   * Set this document's modification date metadata. The modification date will\n   * appear in the \"Document Properties\" section of most PDF readers. For\n   * example:\n   * ```js\n   * pdfDoc.setModificationDate(new Date())\n   * ```\n   * @param modificationDate The date this document was last modified.\n   */\n  PDFDocument.prototype.setModificationDate = function (modificationDate) {\n    utils_1.assertIs(modificationDate, 'modificationDate', [[Date, 'Date']]);\n    var key = core_1.PDFName.of('ModDate');\n    this.getInfoDict().set(key, core_1.PDFString.fromDate(modificationDate));\n  };\n  /**\n   * Get the number of pages contained in this document. For example:\n   * ```js\n   * const totalPages = pdfDoc.getPageCount()\n   * ```\n   * @returns The number of pages in this document.\n   */\n  PDFDocument.prototype.getPageCount = function () {\n    if (this.pageCount === undefined) this.pageCount = this.getPages().length;\n    return this.pageCount;\n  };\n  /**\n   * Get an array of all the pages contained in this document. The pages are\n   * stored in the array in the same order that they are rendered in the\n   * document. For example:\n   * ```js\n   * const pages = pdfDoc.getPages()\n   * pages[0]   // The first page of the document\n   * pages[2]   // The third page of the document\n   * pages[197] // The 198th page of the document\n   * ```\n   * @returns An array of all the pages contained in this document.\n   */\n  PDFDocument.prototype.getPages = function () {\n    return this.pageCache.access();\n  };\n  /**\n   * Get the page rendered at a particular `index` of the document. For example:\n   * ```js\n   * pdfDoc.getPage(0)   // The first page of the document\n   * pdfDoc.getPage(2)   // The third page of the document\n   * pdfDoc.getPage(197) // The 198th page of the document\n   * ```\n   * @returns The [[PDFPage]] rendered at the given `index` of the document.\n   */\n  PDFDocument.prototype.getPage = function (index) {\n    var pages = this.getPages();\n    utils_1.assertRange(index, 'index', 0, pages.length - 1);\n    return pages[index];\n  };\n  /**\n   * Get an array of indices for all the pages contained in this document. The\n   * array will contain a range of integers from\n   * `0..pdfDoc.getPageCount() - 1`. For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   * pdfDoc.addPage()\n   * pdfDoc.addPage()\n   * pdfDoc.addPage()\n   *\n   * const indices = pdfDoc.getPageIndices()\n   * indices // => [0, 1, 2]\n   * ```\n   * @returns An array of indices for all pages contained in this document.\n   */\n  PDFDocument.prototype.getPageIndices = function () {\n    return utils_1.range(0, this.getPageCount());\n  };\n  /**\n   * Remove the page at a given index from this document. For example:\n   * ```js\n   * pdfDoc.removePage(0)   // Remove the first page of the document\n   * pdfDoc.removePage(2)   // Remove the third page of the document\n   * pdfDoc.removePage(197) // Remove the 198th page of the document\n   * ```\n   * Once a page has been removed, it will no longer be rendered at that index\n   * in the document.\n   * @param index The index of the page to be removed.\n   */\n  PDFDocument.prototype.removePage = function (index) {\n    var pageCount = this.getPageCount();\n    if (this.pageCount === 0) throw new errors_1.RemovePageFromEmptyDocumentError();\n    utils_1.assertRange(index, 'index', 0, pageCount - 1);\n    this.catalog.removeLeafNode(index);\n    this.pageCount = pageCount - 1;\n  };\n  /**\n   * Add a page to the end of this document. This method accepts three\n   * different value types for the `page` parameter:\n   *\n   * | Type               | Behavior                                                                            |\n   * | ------------------ | ----------------------------------------------------------------------------------- |\n   * | `undefined`        | Create a new page and add it to the end of this document                            |\n   * | `[number, number]` | Create a new page with the given dimensions and add it to the end of this document  |\n   * | `PDFPage`          | Add the existing page to the end of this document                                   |\n   *\n   * For example:\n   * ```js\n   * // page=undefined\n   * const newPage = pdfDoc.addPage()\n   *\n   * // page=[number, number]\n   * import { PageSizes } from 'pdf-lib'\n   * const newPage1 = pdfDoc.addPage(PageSizes.A7)\n   * const newPage2 = pdfDoc.addPage(PageSizes.Letter)\n   * const newPage3 = pdfDoc.addPage([500, 750])\n   *\n   * // page=PDFPage\n   * const pdfDoc1 = await PDFDocument.create()\n   * const pdfDoc2 = await PDFDocument.load(...)\n   * const [existingPage] = await pdfDoc1.copyPages(pdfDoc2, [0])\n   * pdfDoc1.addPage(existingPage)\n   * ```\n   *\n   * @param page Optionally, the desired dimensions or existing page.\n   * @returns The newly created (or existing) page.\n   */\n  PDFDocument.prototype.addPage = function (page) {\n    utils_1.assertIs(page, 'page', ['undefined', [PDFPage_1.default, 'PDFPage'], Array]);\n    return this.insertPage(this.getPageCount(), page);\n  };\n  /**\n   * Insert a page at a given index within this document. This method accepts\n   * three different value types for the `page` parameter:\n   *\n   * | Type               | Behavior                                                                       |\n   * | ------------------ | ------------------------------------------------------------------------------ |\n   * | `undefined`        | Create a new page and insert it into this document                             |\n   * | `[number, number]` | Create a new page with the given dimensions and insert it into this document   |\n   * | `PDFPage`          | Insert the existing page into this document                                    |\n   *\n   * For example:\n   * ```js\n   * // page=undefined\n   * const newPage = pdfDoc.insertPage(2)\n   *\n   * // page=[number, number]\n   * import { PageSizes } from 'pdf-lib'\n   * const newPage1 = pdfDoc.insertPage(2, PageSizes.A7)\n   * const newPage2 = pdfDoc.insertPage(0, PageSizes.Letter)\n   * const newPage3 = pdfDoc.insertPage(198, [500, 750])\n   *\n   * // page=PDFPage\n   * const pdfDoc1 = await PDFDocument.create()\n   * const pdfDoc2 = await PDFDocument.load(...)\n   * const [existingPage] = await pdfDoc1.copyPages(pdfDoc2, [0])\n   * pdfDoc1.insertPage(0, existingPage)\n   * ```\n   *\n   * @param index The index at which the page should be inserted (zero-based).\n   * @param page Optionally, the desired dimensions or existing page.\n   * @returns The newly created (or existing) page.\n   */\n  PDFDocument.prototype.insertPage = function (index, page) {\n    var pageCount = this.getPageCount();\n    utils_1.assertRange(index, 'index', 0, pageCount);\n    utils_1.assertIs(page, 'page', ['undefined', [PDFPage_1.default, 'PDFPage'], Array]);\n    if (!page || Array.isArray(page)) {\n      var dims = Array.isArray(page) ? page : sizes_1.PageSizes.A4;\n      page = PDFPage_1.default.create(this);\n      page.setSize.apply(page, dims);\n    } else if (page.doc !== this) {\n      throw new errors_1.ForeignPageError();\n    }\n    var parentRef = this.catalog.insertLeafNode(page.ref, index);\n    page.node.setParent(parentRef);\n    this.pageMap.set(page.node, page);\n    this.pageCache.invalidate();\n    this.pageCount = pageCount + 1;\n    return page;\n  };\n  /**\n   * Copy pages from a source document into this document. Allows pages to be\n   * copied between different [[PDFDocument]] instances. For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   * const srcDoc = await PDFDocument.load(...)\n   *\n   * const copiedPages = await pdfDoc.copyPages(srcDoc, [0, 3, 89])\n   * const [firstPage, fourthPage, ninetiethPage] = copiedPages;\n   *\n   * pdfDoc.addPage(fourthPage)\n   * pdfDoc.insertPage(0, ninetiethPage)\n   * pdfDoc.addPage(firstPage)\n   * ```\n   * @param srcDoc The document from which pages should be copied.\n   * @param indices The indices of the pages that should be copied.\n   * @returns Resolves with an array of pages copied into this document.\n   */\n  PDFDocument.prototype.copyPages = function (srcDoc, indices) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var copier, srcPages, copiedPages, idx, len, srcPage, copiedPage, ref;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            utils_1.assertIs(srcDoc, 'srcDoc', [[PDFDocument, 'PDFDocument']]);\n            utils_1.assertIs(indices, 'indices', [Array]);\n            return [4 /*yield*/, srcDoc.flush()];\n          case 1:\n            _a.sent();\n            copier = core_1.PDFObjectCopier.for(srcDoc.context, this.context);\n            srcPages = srcDoc.getPages();\n            copiedPages = new Array(indices.length);\n            for (idx = 0, len = indices.length; idx < len; idx++) {\n              srcPage = srcPages[indices[idx]];\n              copiedPage = copier.copy(srcPage.node);\n              ref = this.context.register(copiedPage);\n              copiedPages[idx] = PDFPage_1.default.of(copiedPage, ref, this);\n            }\n            return [2 /*return*/, copiedPages];\n        }\n      });\n    });\n  };\n  /**\n   * Get a copy of this document.\n   *\n   * For example:\n   * ```js\n   * const srcDoc = await PDFDocument.load(...)\n   * const pdfDoc = await srcDoc.copy()\n   * ```\n   *\n   * > **NOTE:**  This method won't copy all information over to the new\n   * > document (acroforms, outlines, etc...).\n   *\n   * @returns Resolves with a copy this document.\n   */\n  PDFDocument.prototype.copy = function () {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var pdfCopy, contentPages, idx, len;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, PDFDocument.create()];\n          case 1:\n            pdfCopy = _a.sent();\n            return [4 /*yield*/, pdfCopy.copyPages(this, this.getPageIndices())];\n          case 2:\n            contentPages = _a.sent();\n            for (idx = 0, len = contentPages.length; idx < len; idx++) {\n              pdfCopy.addPage(contentPages[idx]);\n            }\n            if (this.getAuthor() !== undefined) {\n              pdfCopy.setAuthor(this.getAuthor());\n            }\n            if (this.getCreationDate() !== undefined) {\n              pdfCopy.setCreationDate(this.getCreationDate());\n            }\n            if (this.getCreator() !== undefined) {\n              pdfCopy.setCreator(this.getCreator());\n            }\n            if (this.getModificationDate() !== undefined) {\n              pdfCopy.setModificationDate(this.getModificationDate());\n            }\n            if (this.getProducer() !== undefined) {\n              pdfCopy.setProducer(this.getProducer());\n            }\n            if (this.getSubject() !== undefined) {\n              pdfCopy.setSubject(this.getSubject());\n            }\n            if (this.getTitle() !== undefined) {\n              pdfCopy.setTitle(this.getTitle());\n            }\n            pdfCopy.defaultWordBreaks = this.defaultWordBreaks;\n            return [2 /*return*/, pdfCopy];\n        }\n      });\n    });\n  };\n  /**\n   * Add JavaScript to this document. The supplied `script` is executed when the\n   * document is opened. The `script` can be used to perform some operation\n   * when the document is opened (e.g. logging to the console), or it can be\n   * used to define a function that can be referenced later in a JavaScript\n   * action. For example:\n   * ```js\n   * // Show \"Hello World!\" in the console when the PDF is opened\n   * pdfDoc.addJavaScript(\n   *   'main',\n   *   'console.show(); console.println(\"Hello World!\");'\n   * );\n   *\n   * // Define a function named \"foo\" that can be called in JavaScript Actions\n   * pdfDoc.addJavaScript(\n   *   'foo',\n   *   'function foo() { return \"foo\"; }'\n   * );\n   * ```\n   * See the [JavaScript for Acrobat API Reference](https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/js_api_reference.pdf)\n   * for details.\n   * @param name The name of the script. Must be unique per document.\n   * @param script The JavaScript to execute.\n   */\n  PDFDocument.prototype.addJavaScript = function (name, script) {\n    utils_1.assertIs(name, 'name', ['string']);\n    utils_1.assertIs(script, 'script', ['string']);\n    var embedder = JavaScriptEmbedder_1.default.for(script, name);\n    var ref = this.context.nextRef();\n    var javaScript = PDFJavaScript_1.default.of(ref, this, embedder);\n    this.javaScripts.push(javaScript);\n  };\n  /**\n   * Add an attachment to this document. Attachments are visible in the\n   * \"Attachments\" panel of Adobe Acrobat and some other PDF readers. Any\n   * type of file can be added as an attachment. This includes, but is not\n   * limited to, `.png`, `.jpg`, `.pdf`, `.csv`, `.docx`, and `.xlsx` files.\n   *\n   * The input data can be provided in multiple formats:\n   *\n   * | Type          | Contents                                                       |\n   * | ------------- | -------------------------------------------------------------- |\n   * | `string`      | A base64 encoded string (or data URI) containing an attachment |\n   * | `Uint8Array`  | The raw bytes of an attachment                                 |\n   * | `ArrayBuffer` | The raw bytes of an attachment                                 |\n   *\n   * For example:\n   * ```js\n   * // attachment=string\n   * await pdfDoc.attach('/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD...', 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   * await pdfDoc.attach('data:image/jpeg;base64,/9j/4AAQ...', 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   *\n   * // attachment=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('cat_riding_unicorn.jpg')\n   * await pdfDoc.attach(uint8Array, 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   *\n   * // attachment=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * await pdfDoc.attach(arrayBuffer, 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   * ```\n   *\n   * @param attachment The input data containing the file to be attached.\n   * @param name The name of the file to be attached.\n   * @returns Resolves when the attachment is complete.\n   */\n  PDFDocument.prototype.attach = function (attachment, name, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var bytes, embedder, ref, embeddedFile;\n      return tslib_1.__generator(this, function (_a) {\n        utils_1.assertIs(attachment, 'attachment', ['string', Uint8Array, ArrayBuffer]);\n        utils_1.assertIs(name, 'name', ['string']);\n        utils_1.assertOrUndefined(options.mimeType, 'mimeType', ['string']);\n        utils_1.assertOrUndefined(options.description, 'description', ['string']);\n        utils_1.assertOrUndefined(options.creationDate, 'options.creationDate', [Date]);\n        utils_1.assertOrUndefined(options.modificationDate, 'options.modificationDate', [Date]);\n        utils_1.assertIsOneOfOrUndefined(options.afRelationship, 'options.afRelationship', FileEmbedder_1.AFRelationship);\n        bytes = utils_1.toUint8Array(attachment);\n        embedder = FileEmbedder_1.default.for(bytes, name, options);\n        ref = this.context.nextRef();\n        embeddedFile = PDFEmbeddedFile_1.default.of(ref, this, embedder);\n        this.embeddedFiles.push(embeddedFile);\n        return [2 /*return*/];\n      });\n    });\n  };\n  /**\n   * Embed a font into this document. The input data can be provided in multiple\n   * formats:\n   *\n   * | Type            | Contents                                                |\n   * | --------------- | ------------------------------------------------------- |\n   * | `StandardFonts` | One of the standard 14 fonts                            |\n   * | `string`        | A base64 encoded string (or data URI) containing a font |\n   * | `Uint8Array`    | The raw bytes of a font                                 |\n   * | `ArrayBuffer`   | The raw bytes of a font                                 |\n   *\n   * For example:\n   * ```js\n   * // font=StandardFonts\n   * import { StandardFonts } from 'pdf-lib'\n   * const font1 = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   *\n   * // font=string\n   * const font2 = await pdfDoc.embedFont('AAEAAAAVAQAABABQRFNJRx/upe...')\n   * const font3 = await pdfDoc.embedFont('data:font/opentype;base64,AAEAAA...')\n   *\n   * // font=Uint8Array\n   * import fs from 'fs'\n   * const font4 = await pdfDoc.embedFont(fs.readFileSync('Ubuntu-R.ttf'))\n   *\n   * // font=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/ubuntu/Ubuntu-R.ttf'\n   * const ubuntuBytes = await fetch(url).then(res => res.arrayBuffer())\n   * const font5 = await pdfDoc.embedFont(ubuntuBytes)\n   * ```\n   * See also: [[registerFontkit]]\n   * @param font The input data for a font.\n   * @param options The options to be used when embedding the font.\n   * @returns Resolves with the embedded font.\n   */\n  PDFDocument.prototype.embedFont = function (font, options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, subset, customName, features, embedder, bytes, fontkit, _b, ref, pdfFont;\n      return tslib_1.__generator(this, function (_c) {\n        switch (_c.label) {\n          case 0:\n            _a = options.subset, subset = _a === void 0 ? false : _a, customName = options.customName, features = options.features;\n            utils_1.assertIs(font, 'font', ['string', Uint8Array, ArrayBuffer]);\n            utils_1.assertIs(subset, 'subset', ['boolean']);\n            if (!utils_1.isStandardFont(font)) return [3 /*break*/, 1];\n            embedder = core_1.StandardFontEmbedder.for(font, customName);\n            return [3 /*break*/, 7];\n          case 1:\n            if (!utils_1.canBeConvertedToUint8Array(font)) return [3 /*break*/, 6];\n            bytes = utils_1.toUint8Array(font);\n            fontkit = this.assertFontkit();\n            if (!subset) return [3 /*break*/, 3];\n            return [4 /*yield*/, core_1.CustomFontSubsetEmbedder.for(fontkit, bytes, customName, features)];\n          case 2:\n            _b = _c.sent();\n            return [3 /*break*/, 5];\n          case 3:\n            return [4 /*yield*/, core_1.CustomFontEmbedder.for(fontkit, bytes, customName, features)];\n          case 4:\n            _b = _c.sent();\n            _c.label = 5;\n          case 5:\n            embedder = _b;\n            return [3 /*break*/, 7];\n          case 6:\n            throw new TypeError('`font` must be one of `StandardFonts | string | Uint8Array | ArrayBuffer`');\n          case 7:\n            ref = this.context.nextRef();\n            pdfFont = PDFFont_1.default.of(ref, this, embedder);\n            this.fonts.push(pdfFont);\n            return [2 /*return*/, pdfFont];\n        }\n      });\n    });\n  };\n  /**\n   * Embed a standard font into this document.\n   * For example:\n   * ```js\n   * import { StandardFonts } from 'pdf-lib'\n   * const helveticaFont = pdfDoc.embedFont(StandardFonts.Helvetica)\n   * ```\n   * @param font The standard font to be embedded.\n   * @param customName The name to be used when embedding the font.\n   * @returns The embedded font.\n   */\n  PDFDocument.prototype.embedStandardFont = function (font, customName) {\n    utils_1.assertIs(font, 'font', ['string']);\n    if (!utils_1.isStandardFont(font)) {\n      throw new TypeError('`font` must be one of type `StandardFonts`');\n    }\n    var embedder = core_1.StandardFontEmbedder.for(font, customName);\n    var ref = this.context.nextRef();\n    var pdfFont = PDFFont_1.default.of(ref, this, embedder);\n    this.fonts.push(pdfFont);\n    return pdfFont;\n  };\n  /**\n   * Embed a JPEG image into this document. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                                      |\n   * | ------------- | ------------------------------------------------------------- |\n   * | `string`      | A base64 encoded string (or data URI) containing a JPEG image |\n   * | `Uint8Array`  | The raw bytes of a JPEG image                                 |\n   * | `ArrayBuffer` | The raw bytes of a JPEG image                                 |\n   *\n   * For example:\n   * ```js\n   * // jpg=string\n   * const image1 = await pdfDoc.embedJpg('/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD...')\n   * const image2 = await pdfDoc.embedJpg('data:image/jpeg;base64,/9j/4AAQ...')\n   *\n   * // jpg=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('cat_riding_unicorn.jpg')\n   * const image3 = await pdfDoc.embedJpg(uint8Array)\n   *\n   * // jpg=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const image4 = await pdfDoc.embedJpg(arrayBuffer)\n   * ```\n   *\n   * @param jpg The input data for a JPEG image.\n   * @returns Resolves with the embedded image.\n   */\n  PDFDocument.prototype.embedJpg = function (jpg) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var bytes, embedder, ref, pdfImage;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            utils_1.assertIs(jpg, 'jpg', ['string', Uint8Array, ArrayBuffer]);\n            bytes = utils_1.toUint8Array(jpg);\n            return [4 /*yield*/, core_1.JpegEmbedder.for(bytes)];\n          case 1:\n            embedder = _a.sent();\n            ref = this.context.nextRef();\n            pdfImage = PDFImage_1.default.of(ref, this, embedder);\n            this.images.push(pdfImage);\n            return [2 /*return*/, pdfImage];\n        }\n      });\n    });\n  };\n  /**\n   * Embed a PNG image into this document. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                                     |\n   * | ------------- | ------------------------------------------------------------ |\n   * | `string`      | A base64 encoded string (or data URI) containing a PNG image |\n   * | `Uint8Array`  | The raw bytes of a PNG image                                 |\n   * | `ArrayBuffer` | The raw bytes of a PNG image                                 |\n   *\n   * For example:\n   * ```js\n   * // png=string\n   * const image1 = await pdfDoc.embedPng('iVBORw0KGgoAAAANSUhEUgAAAlgAAAF3...')\n   * const image2 = await pdfDoc.embedPng('data:image/png;base64,iVBORw0KGg...')\n   *\n   * // png=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('small_mario.png')\n   * const image3 = await pdfDoc.embedPng(uint8Array)\n   *\n   * // png=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/small_mario.png'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const image4 = await pdfDoc.embedPng(arrayBuffer)\n   * ```\n   *\n   * @param png The input data for a PNG image.\n   * @returns Resolves with the embedded image.\n   */\n  PDFDocument.prototype.embedPng = function (png) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var bytes, embedder, ref, pdfImage;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            utils_1.assertIs(png, 'png', ['string', Uint8Array, ArrayBuffer]);\n            bytes = utils_1.toUint8Array(png);\n            return [4 /*yield*/, core_1.PngEmbedder.for(bytes)];\n          case 1:\n            embedder = _a.sent();\n            ref = this.context.nextRef();\n            pdfImage = PDFImage_1.default.of(ref, this, embedder);\n            this.images.push(pdfImage);\n            return [2 /*return*/, pdfImage];\n        }\n      });\n    });\n  };\n  /**\n   * Embed one or more PDF pages into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourcePdf = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   *\n   * // Embed page 74 of `sourcePdf` into `pdfDoc`\n   * const [embeddedPage] = await pdfDoc.embedPdf(sourcePdf, [73])\n   * ```\n   *\n   * See [[PDFDocument.load]] for examples of the allowed input data formats.\n   *\n   * @param pdf The input data containing a PDF document.\n   * @param indices The indices of the pages that should be embedded.\n   * @returns Resolves with an array of the embedded pages.\n   */\n  PDFDocument.prototype.embedPdf = function (pdf, indices) {\n    if (indices === void 0) {\n      indices = [0];\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var srcDoc, _a, srcPages;\n      return tslib_1.__generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            utils_1.assertIs(pdf, 'pdf', ['string', Uint8Array, ArrayBuffer, [PDFDocument, 'PDFDocument']]);\n            utils_1.assertIs(indices, 'indices', [Array]);\n            if (!(pdf instanceof PDFDocument)) return [3 /*break*/, 1];\n            _a = pdf;\n            return [3 /*break*/, 3];\n          case 1:\n            return [4 /*yield*/, PDFDocument.load(pdf)];\n          case 2:\n            _a = _b.sent();\n            _b.label = 3;\n          case 3:\n            srcDoc = _a;\n            srcPages = utils_1.pluckIndices(srcDoc.getPages(), indices);\n            return [2 /*return*/, this.embedPages(srcPages)];\n        }\n      });\n    });\n  };\n  /**\n   * Embed a single PDF page into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourceBuffer = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   * const sourcePdfDoc = await PDFDocument.load(sourceBuffer)\n   * const sourcePdfPage = sourcePdfDoc.getPages()[73]\n   *\n   * const embeddedPage = await pdfDoc.embedPage(\n   *   sourcePdfPage,\n   *\n   *   // Clip a section of the source page so that we only embed part of it\n   *   { left: 100, right: 450, bottom: 330, top: 570 },\n   *\n   *   // Translate all drawings of the embedded page by (10, 200) units\n   *   [1, 0, 0, 1, 10, 200],\n   * )\n   * ```\n   *\n   * @param page The page to be embedded.\n   * @param boundingBox\n   * Optionally, an area of the source page that should be embedded\n   * (defaults to entire page).\n   * @param transformationMatrix\n   * Optionally, a transformation matrix that is always applied to the embedded\n   * page anywhere it is drawn.\n   * @returns Resolves with the embedded pdf page.\n   */\n  PDFDocument.prototype.embedPage = function (page, boundingBox, transformationMatrix) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var embeddedPage;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            utils_1.assertIs(page, 'page', [[PDFPage_1.default, 'PDFPage']]);\n            return [4 /*yield*/, this.embedPages([page], [boundingBox], [transformationMatrix])];\n          case 1:\n            embeddedPage = _a.sent()[0];\n            return [2 /*return*/, embeddedPage];\n        }\n      });\n    });\n  };\n  /**\n   * Embed one or more PDF pages into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourceBuffer = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   * const sourcePdfDoc = await PDFDocument.load(sourceBuffer)\n   *\n   * const page1 = sourcePdfDoc.getPages()[0]\n   * const page2 = sourcePdfDoc.getPages()[52]\n   * const page3 = sourcePdfDoc.getPages()[73]\n   *\n   * const embeddedPages = await pdfDoc.embedPages([page1, page2, page3])\n   * ```\n   *\n   * @param page\n   * The pages to be embedded (they must all share the same context).\n   * @param boundingBoxes\n   * Optionally, an array of clipping boundaries - one for each page\n   * (defaults to entirety of each page).\n   * @param transformationMatrices\n   * Optionally, an array of transformation matrices - one for each page\n   * (each page's transformation will apply anywhere it is drawn).\n   * @returns Resolves with an array of the embedded pdf pages.\n   */\n  PDFDocument.prototype.embedPages = function (pages, boundingBoxes, transformationMatrices) {\n    if (boundingBoxes === void 0) {\n      boundingBoxes = [];\n    }\n    if (transformationMatrices === void 0) {\n      transformationMatrices = [];\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var idx, len, currPage, nextPage, context, maybeCopyPage, embeddedPages, idx, len, page, box, matrix, embedder, ref;\n      var _a;\n      return tslib_1.__generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (pages.length === 0) return [2 /*return*/, []];\n            // Assert all pages have the same context\n            for (idx = 0, len = pages.length - 1; idx < len; idx++) {\n              currPage = pages[idx];\n              nextPage = pages[idx + 1];\n              if (currPage.node.context !== nextPage.node.context) {\n                throw new core_1.PageEmbeddingMismatchedContextError();\n              }\n            }\n            context = pages[0].node.context;\n            maybeCopyPage = context === this.context ? function (p) {\n              return p;\n            } : core_1.PDFObjectCopier.for(context, this.context).copy;\n            embeddedPages = new Array(pages.length);\n            idx = 0, len = pages.length;\n            _b.label = 1;\n          case 1:\n            if (!(idx < len)) return [3 /*break*/, 4];\n            page = maybeCopyPage(pages[idx].node);\n            box = boundingBoxes[idx];\n            matrix = transformationMatrices[idx];\n            return [4 /*yield*/, core_1.PDFPageEmbedder.for(page, box, matrix)];\n          case 2:\n            embedder = _b.sent();\n            ref = this.context.nextRef();\n            embeddedPages[idx] = PDFEmbeddedPage_1.default.of(ref, this, embedder);\n            _b.label = 3;\n          case 3:\n            idx++;\n            return [3 /*break*/, 1];\n          case 4:\n            (_a = this.embeddedPages).push.apply(_a, embeddedPages);\n            return [2 /*return*/, embeddedPages];\n        }\n      });\n    });\n  };\n  /**\n   * > **NOTE:** You shouldn't need to call this method directly. The [[save]]\n   * > and [[saveAsBase64]] methods will automatically ensure that all embedded\n   * > assets are flushed before serializing the document.\n   *\n   * Flush all embedded fonts, PDF pages, and images to this document's\n   * [[context]].\n   *\n   * @returns Resolves when the flush is complete.\n   */\n  PDFDocument.prototype.flush = function () {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, this.embedAll(this.fonts)];\n          case 1:\n            _a.sent();\n            return [4 /*yield*/, this.embedAll(this.images)];\n          case 2:\n            _a.sent();\n            return [4 /*yield*/, this.embedAll(this.embeddedPages)];\n          case 3:\n            _a.sent();\n            return [4 /*yield*/, this.embedAll(this.embeddedFiles)];\n          case 4:\n            _a.sent();\n            return [4 /*yield*/, this.embedAll(this.javaScripts)];\n          case 5:\n            _a.sent();\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  /**\n   * Serialize this document to an array of bytes making up a PDF file.\n   * For example:\n   * ```js\n   * const pdfBytes = await pdfDoc.save()\n   * ```\n   *\n   * There are a number of things you can do with the serialized document,\n   * depending on the JavaScript environment you're running in:\n   * * Write it to a file in Node or React Native\n   * * Download it as a Blob in the browser\n   * * Render it in an `iframe`\n   *\n   * @param options The options to be used when saving the document.\n   * @returns Resolves with the bytes of the serialized document.\n   */\n  PDFDocument.prototype.save = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, useObjectStreams, _b, addDefaultPage, _c, objectsPerTick, _d, updateFieldAppearances, form, Writer;\n      return tslib_1.__generator(this, function (_e) {\n        switch (_e.label) {\n          case 0:\n            _a = options.useObjectStreams, useObjectStreams = _a === void 0 ? true : _a, _b = options.addDefaultPage, addDefaultPage = _b === void 0 ? true : _b, _c = options.objectsPerTick, objectsPerTick = _c === void 0 ? 50 : _c, _d = options.updateFieldAppearances, updateFieldAppearances = _d === void 0 ? true : _d;\n            utils_1.assertIs(useObjectStreams, 'useObjectStreams', ['boolean']);\n            utils_1.assertIs(addDefaultPage, 'addDefaultPage', ['boolean']);\n            utils_1.assertIs(objectsPerTick, 'objectsPerTick', ['number']);\n            utils_1.assertIs(updateFieldAppearances, 'updateFieldAppearances', ['boolean']);\n            if (addDefaultPage && this.getPageCount() === 0) this.addPage();\n            if (updateFieldAppearances) {\n              form = this.formCache.getValue();\n              if (form) form.updateFieldAppearances();\n            }\n            return [4 /*yield*/, this.flush()];\n          case 1:\n            _e.sent();\n            Writer = useObjectStreams ? core_1.PDFStreamWriter : core_1.PDFWriter;\n            return [2 /*return*/, Writer.forContext(this.context, objectsPerTick).serializeToBuffer()];\n        }\n      });\n    });\n  };\n  /**\n   * Serialize this document to a base64 encoded string or data URI making up a\n   * PDF file. For example:\n   * ```js\n   * const base64String = await pdfDoc.saveAsBase64()\n   * base64String // => 'JVBERi0xLjcKJYGBgYEKC...'\n   *\n   * const base64DataUri = await pdfDoc.saveAsBase64({ dataUri: true })\n   * base64DataUri // => 'data:application/pdf;base64,JVBERi0xLjcKJYGBgYEKC...'\n   * ```\n   *\n   * @param options The options to be used when saving the document.\n   * @returns Resolves with a base64 encoded string or data URI of the\n   *          serialized document.\n   */\n  PDFDocument.prototype.saveAsBase64 = function (options) {\n    if (options === void 0) {\n      options = {};\n    }\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var _a, dataUri, otherOptions, bytes, base64;\n      return tslib_1.__generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            _a = options.dataUri, dataUri = _a === void 0 ? false : _a, otherOptions = tslib_1.__rest(options, [\"dataUri\"]);\n            utils_1.assertIs(dataUri, 'dataUri', ['boolean']);\n            return [4 /*yield*/, this.save(otherOptions)];\n          case 1:\n            bytes = _b.sent();\n            base64 = utils_1.encodeToBase64(bytes);\n            return [2 /*return*/, dataUri ? \"data:application/pdf;base64,\" + base64 : base64];\n        }\n      });\n    });\n  };\n  PDFDocument.prototype.findPageForAnnotationRef = function (ref) {\n    var pages = this.getPages();\n    for (var idx = 0, len = pages.length; idx < len; idx++) {\n      var page = pages[idx];\n      var annotations = page.node.Annots();\n      if ((annotations === null || annotations === void 0 ? void 0 : annotations.indexOf(ref)) !== undefined) {\n        return page;\n      }\n    }\n    return undefined;\n  };\n  PDFDocument.prototype.embedAll = function (embeddables) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var idx, len;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            idx = 0, len = embeddables.length;\n            _a.label = 1;\n          case 1:\n            if (!(idx < len)) return [3 /*break*/, 4];\n            return [4 /*yield*/, embeddables[idx].embed()];\n          case 2:\n            _a.sent();\n            _a.label = 3;\n          case 3:\n            idx++;\n            return [3 /*break*/, 1];\n          case 4:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n  PDFDocument.prototype.updateInfoDict = function () {\n    var pdfLib = \"pdf-lib (https://github.com/Hopding/pdf-lib)\";\n    var now = new Date();\n    var info = this.getInfoDict();\n    this.setProducer(pdfLib);\n    this.setModificationDate(now);\n    if (!info.get(core_1.PDFName.of('Creator'))) this.setCreator(pdfLib);\n    if (!info.get(core_1.PDFName.of('CreationDate'))) this.setCreationDate(now);\n  };\n  PDFDocument.prototype.getInfoDict = function () {\n    var existingInfo = this.context.lookup(this.context.trailerInfo.Info);\n    if (existingInfo instanceof core_1.PDFDict) return existingInfo;\n    var newInfo = this.context.obj({});\n    this.context.trailerInfo.Info = this.context.register(newInfo);\n    return newInfo;\n  };\n  PDFDocument.prototype.assertFontkit = function () {\n    if (!this.fontkit) throw new errors_1.FontkitNotRegisteredError();\n    return this.fontkit;\n  };\n  return PDFDocument;\n}();\nexports.default = PDFDocument;\n/* tslint:disable-next-line only-arrow-functions */\nfunction assertIsLiteralOrHexString(pdfObject) {\n  if (!(pdfObject instanceof core_1.PDFHexString) && !(pdfObject instanceof core_1.PDFString)) {\n    throw new core_1.UnexpectedObjectTypeError([core_1.PDFHexString, core_1.PDFString], pdfObject);\n  }\n}","map":{"version":3,"names":["errors_1","require","PDFEmbeddedPage_1","tslib_1","__importDefault","PDFFont_1","PDFImage_1","PDFPage_1","PDFForm_1","sizes_1","core_1","PDFDocumentOptions_1","utils_1","FileEmbedder_1","__importStar","PDFEmbeddedFile_1","PDFJavaScript_1","JavaScriptEmbedder_1","PDFDocument","context","ignoreEncryption","updateMetadata","_this","defaultWordBreaks","computePages","pages","catalog","Pages","traverse","node","ref","PDFPageLeaf","page","pageMap","get","default","of","set","push","getOrCreateForm","acroForm","getOrCreateAcroForm","assertIs","PDFContext","lookup","trailerInfo","Root","isEncrypted","Encrypt","pageCache","Cache","populatedBy","Map","formCache","fonts","images","embeddedPages","embeddedFiles","javaScripts","EncryptedPDFError","updateInfoDict","load","pdf","options","_a","_b","parseSpeed","ParseSpeeds","Slow","_c","throwOnInvalidObject","_d","_e","capNumbers","Uint8Array","ArrayBuffer","bytes","toUint8Array","PDFParser","forBytesWithOptions","parseDocument","_f","sent","create","pageTree","PDFPageTree","withContext","pageTreeRef","register","PDFCatalog","withContextAndPages","prototype","registerFontkit","fontkit","getForm","form","access","hasXFA","console","warn","deleteXFA","getTitle","title","getInfoDict","PDFName","Title","undefined","assertIsLiteralOrHexString","decodeText","getAuthor","author","Author","getSubject","subject","Subject","getKeywords","keywords","Keywords","getCreator","creator","Creator","getProducer","producer","Producer","getCreationDate","creationDate","CreationDate","decodeDate","getModificationDate","modificationDate","ModDate","setTitle","key","PDFHexString","fromText","showInWindowTitleBar","prefs","getOrCreateViewerPreferences","setDisplayDocTitle","setAuthor","setSubject","setKeywords","Array","join","setCreator","setProducer","setLanguage","language","PDFString","setCreationDate","Date","fromDate","setModificationDate","getPageCount","pageCount","getPages","length","getPage","index","assertRange","getPageIndices","range","removePage","RemovePageFromEmptyDocumentError","removeLeafNode","addPage","insertPage","isArray","dims","PageSizes","A4","setSize","apply","doc","ForeignPageError","parentRef","insertLeafNode","setParent","invalidate","copyPages","srcDoc","indices","flush","copier","PDFObjectCopier","for","srcPages","copiedPages","idx","len","srcPage","copiedPage","copy","pdfCopy","contentPages","addJavaScript","name","script","embedder","nextRef","javaScript","attach","attachment","assertOrUndefined","mimeType","description","assertIsOneOfOrUndefined","afRelationship","AFRelationship","embeddedFile","embedFont","font","subset","customName","features","isStandardFont","StandardFontEmbedder","canBeConvertedToUint8Array","assertFontkit","CustomFontSubsetEmbedder","CustomFontEmbedder","TypeError","pdfFont","embedStandardFont","embedJpg","jpg","JpegEmbedder","pdfImage","embedPng","png","PngEmbedder","embedPdf","pluckIndices","embedPages","embedPage","boundingBox","transformationMatrix","embeddedPage","boundingBoxes","transformationMatrices","currPage","nextPage","PageEmbeddingMismatchedContextError","maybeCopyPage","p","box","matrix","PDFPageEmbedder","embedAll","save","useObjectStreams","addDefaultPage","objectsPerTick","updateFieldAppearances","getValue","Writer","PDFStreamWriter","PDFWriter","forContext","serializeToBuffer","saveAsBase64","dataUri","otherOptions","__rest","base64","encodeToBase64","findPageForAnnotationRef","annotations","Annots","indexOf","embeddables","embed","pdfLib","now","info","existingInfo","Info","PDFDict","newInfo","obj","FontkitNotRegisteredError","pdfObject","UnexpectedObjectTypeError"],"sources":["/Users/casarulez/Projects/Liquid-neurons/database_forms/data_entry_forms/node_modules/pdf-lib/src/api/PDFDocument.ts"],"sourcesContent":["import Embeddable from 'src/api/Embeddable';\nimport {\n  EncryptedPDFError,\n  FontkitNotRegisteredError,\n  ForeignPageError,\n  RemovePageFromEmptyDocumentError,\n} from 'src/api/errors';\nimport PDFEmbeddedPage from 'src/api/PDFEmbeddedPage';\nimport PDFFont from 'src/api/PDFFont';\nimport PDFImage from 'src/api/PDFImage';\nimport PDFPage from 'src/api/PDFPage';\nimport PDFForm from 'src/api/form/PDFForm';\nimport { PageSizes } from 'src/api/sizes';\nimport { StandardFonts } from 'src/api/StandardFonts';\nimport {\n  CustomFontEmbedder,\n  CustomFontSubsetEmbedder,\n  JpegEmbedder,\n  PageBoundingBox,\n  PageEmbeddingMismatchedContextError,\n  PDFCatalog,\n  PDFContext,\n  PDFDict,\n  PDFHexString,\n  PDFName,\n  PDFObjectCopier,\n  PDFPageEmbedder,\n  PDFPageLeaf,\n  PDFPageTree,\n  PDFParser,\n  PDFStreamWriter,\n  PDFString,\n  PDFWriter,\n  PngEmbedder,\n  StandardFontEmbedder,\n  UnexpectedObjectTypeError,\n} from 'src/core';\nimport {\n  ParseSpeeds,\n  AttachmentOptions,\n  SaveOptions,\n  Base64SaveOptions,\n  LoadOptions,\n  CreateOptions,\n  EmbedFontOptions,\n  SetTitleOptions,\n} from 'src/api/PDFDocumentOptions';\nimport PDFObject from 'src/core/objects/PDFObject';\nimport PDFRef from 'src/core/objects/PDFRef';\nimport { Fontkit } from 'src/types/fontkit';\nimport { TransformationMatrix } from 'src/types/matrix';\nimport {\n  assertIs,\n  assertIsOneOfOrUndefined,\n  assertOrUndefined,\n  assertRange,\n  Cache,\n  canBeConvertedToUint8Array,\n  encodeToBase64,\n  isStandardFont,\n  pluckIndices,\n  range,\n  toUint8Array,\n} from 'src/utils';\nimport FileEmbedder, { AFRelationship } from 'src/core/embedders/FileEmbedder';\nimport PDFEmbeddedFile from 'src/api/PDFEmbeddedFile';\nimport PDFJavaScript from 'src/api/PDFJavaScript';\nimport JavaScriptEmbedder from 'src/core/embedders/JavaScriptEmbedder';\n\n/**\n * Represents a PDF document.\n */\nexport default class PDFDocument {\n  /**\n   * Load an existing [[PDFDocument]]. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                               |\n   * | ------------- | ------------------------------------------------------ |\n   * | `string`      | A base64 encoded string (or data URI) containing a PDF |\n   * | `Uint8Array`  | The raw bytes of a PDF                                 |\n   * | `ArrayBuffer` | The raw bytes of a PDF                                 |\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   *\n   * // pdf=string\n   * const base64 =\n   *  'JVBERi0xLjcKJYGBgYEKCjUgMCBvYmoKPDwKL0ZpbHRlciAvRmxhdGVEZWNvZGUKL0xlbm' +\n   *  'd0aCAxMDQKPj4Kc3RyZWFtCniccwrhMlAAwaJ0Ln2P1Jyy1JLM5ERdc0MjCwUjE4WQNC4Q' +\n   *  '6cNlCFZkqGCqYGSqEJLLZWNuYGZiZmbkYuZsZmlmZGRgZmluDCQNzc3NTM2NzdzMXMxMjQ' +\n   *  'ztFEKyuEK0uFxDuAAOERdVCmVuZHN0cmVhbQplbmRvYmoKCjYgMCBvYmoKPDwKL0ZpbHRl' +\n   *  'ciAvRmxhdGVEZWNvZGUKL1R5cGUgL09ialN0bQovTiA0Ci9GaXJzdCAyMAovTGVuZ3RoID' +\n   *  'IxNQo+PgpzdHJlYW0KeJxVj9GqwjAMhu/zFHkBzTo3nCCCiiKIHPEICuJF3cKoSCu2E8/b' +\n   *  '20wPIr1p8v9/8kVhgilmGfawX2CGaVrgcAi0/bsy0lrX7IGWpvJ4iJYEN3gEmrrGBlQwGs' +\n   *  'HHO9VBX1wNrxAqMX87RBD5xpJuddqwd82tjAHxzV1U5LPgy52DKXWnr1Lheg+j/c/pzGVr' +\n   *  'iqV0VlwZPXGPCJjElw/ybkwUmeoWgxesDXGhHJC/D/iikp1Av80ptKU0FdBEe25pPihAM1' +\n   *  'u6ytgaaWfs2Hrz35CJT1+EWmAKZW5kc3RyZWFtCmVuZG9iagoKNyAwIG9iago8PAovU2l6' +\n   *  'ZSA4Ci9Sb290IDIgMCBSCi9GaWx0ZXIgL0ZsYXRlRGVjb2RlCi9UeXBlIC9YUmVmCi9MZW' +\n   *  '5ndGggMzgKL1cgWyAxIDIgMiBdCi9JbmRleCBbIDAgOCBdCj4+CnN0cmVhbQp4nBXEwREA' +\n   *  'EBAEsCwz3vrvRmOOyyOoGhZdutHN2MT55fIAVocD+AplbmRzdHJlYW0KZW5kb2JqCgpzdG' +\n   *  'FydHhyZWYKNTEwCiUlRU9G'\n   *\n   * const dataUri = 'data:application/pdf;base64,' + base64\n   *\n   * const pdfDoc1 = await PDFDocument.load(base64)\n   * const pdfDoc2 = await PDFDocument.load(dataUri)\n   *\n   * // pdf=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('with_update_sections.pdf')\n   * const pdfDoc3 = await PDFDocument.load(uint8Array)\n   *\n   * // pdf=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/with_update_sections.pdf'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const pdfDoc4 = await PDFDocument.load(arrayBuffer)\n   *\n   * ```\n   *\n   * @param pdf The input data containing a PDF document.\n   * @param options The options to be used when loading the document.\n   * @returns Resolves with a document loaded from the input.\n   */\n  static async load(\n    pdf: string | Uint8Array | ArrayBuffer,\n    options: LoadOptions = {},\n  ) {\n    const {\n      ignoreEncryption = false,\n      parseSpeed = ParseSpeeds.Slow,\n      throwOnInvalidObject = false,\n      updateMetadata = true,\n      capNumbers = false,\n    } = options;\n\n    assertIs(pdf, 'pdf', ['string', Uint8Array, ArrayBuffer]);\n    assertIs(ignoreEncryption, 'ignoreEncryption', ['boolean']);\n    assertIs(parseSpeed, 'parseSpeed', ['number']);\n    assertIs(throwOnInvalidObject, 'throwOnInvalidObject', ['boolean']);\n\n    const bytes = toUint8Array(pdf);\n    const context = await PDFParser.forBytesWithOptions(\n      bytes,\n      parseSpeed,\n      throwOnInvalidObject,\n      capNumbers,\n    ).parseDocument();\n    return new PDFDocument(context, ignoreEncryption, updateMetadata);\n  }\n\n  /**\n   * Create a new [[PDFDocument]].\n   * @returns Resolves with the newly created document.\n   */\n  static async create(options: CreateOptions = {}) {\n    const { updateMetadata = true } = options;\n\n    const context = PDFContext.create();\n    const pageTree = PDFPageTree.withContext(context);\n    const pageTreeRef = context.register(pageTree);\n    const catalog = PDFCatalog.withContextAndPages(context, pageTreeRef);\n    context.trailerInfo.Root = context.register(catalog);\n\n    return new PDFDocument(context, false, updateMetadata);\n  }\n\n  /** The low-level context of this document. */\n  readonly context: PDFContext;\n\n  /** The catalog of this document. */\n  readonly catalog: PDFCatalog;\n\n  /** Whether or not this document is encrypted. */\n  readonly isEncrypted: boolean;\n\n  /** The default word breaks used in PDFPage.drawText */\n  defaultWordBreaks: string[] = [' '];\n\n  private fontkit?: Fontkit;\n  private pageCount: number | undefined;\n  private readonly pageCache: Cache<PDFPage[]>;\n  private readonly pageMap: Map<PDFPageLeaf, PDFPage>;\n  private readonly formCache: Cache<PDFForm>;\n  private readonly fonts: PDFFont[];\n  private readonly images: PDFImage[];\n  private readonly embeddedPages: PDFEmbeddedPage[];\n  private readonly embeddedFiles: PDFEmbeddedFile[];\n  private readonly javaScripts: PDFJavaScript[];\n\n  private constructor(\n    context: PDFContext,\n    ignoreEncryption: boolean,\n    updateMetadata: boolean,\n  ) {\n    assertIs(context, 'context', [[PDFContext, 'PDFContext']]);\n    assertIs(ignoreEncryption, 'ignoreEncryption', ['boolean']);\n\n    this.context = context;\n    this.catalog = context.lookup(context.trailerInfo.Root) as PDFCatalog;\n    this.isEncrypted = !!context.lookup(context.trailerInfo.Encrypt);\n\n    this.pageCache = Cache.populatedBy(this.computePages);\n    this.pageMap = new Map();\n    this.formCache = Cache.populatedBy(this.getOrCreateForm);\n    this.fonts = [];\n    this.images = [];\n    this.embeddedPages = [];\n    this.embeddedFiles = [];\n    this.javaScripts = [];\n\n    if (!ignoreEncryption && this.isEncrypted) throw new EncryptedPDFError();\n\n    if (updateMetadata) this.updateInfoDict();\n  }\n\n  /**\n   * Register a fontkit instance. This must be done before custom fonts can\n   * be embedded. See [here](https://github.com/Hopding/pdf-lib/tree/master#fontkit-installation)\n   * for instructions on how to install and register a fontkit instance.\n   *\n   * > You do **not** need to call this method to embed standard fonts.\n   *\n   * For example:\n   * ```js\n   * import { PDFDocument } from 'pdf-lib'\n   * import fontkit from '@pdf-lib/fontkit'\n   *\n   * const pdfDoc = await PDFDocument.create()\n   * pdfDoc.registerFontkit(fontkit)\n   * ```\n   *\n   * @param fontkit The fontkit instance to be registered.\n   */\n  registerFontkit(fontkit: Fontkit): void {\n    this.fontkit = fontkit;\n  }\n\n  /**\n   * Get the [[PDFForm]] containing all interactive fields for this document.\n   * For example:\n   * ```js\n   * const form = pdfDoc.getForm()\n   * const fields = form.getFields()\n   * fields.forEach(field => {\n   *   const type = field.constructor.name\n   *   const name = field.getName()\n   *   console.log(`${type}: ${name}`)\n   * })\n   * ```\n   * @returns The form for this document.\n   */\n  getForm(): PDFForm {\n    const form = this.formCache.access();\n    if (form.hasXFA()) {\n      console.warn(\n        'Removing XFA form data as pdf-lib does not support reading or writing XFA',\n      );\n      form.deleteXFA();\n    }\n    return form;\n  }\n\n  /**\n   * Get this document's title metadata. The title appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const title = pdfDoc.getTitle()\n   * ```\n   * @returns A string containing the title of this document, if it has one.\n   */\n  getTitle(): string | undefined {\n    const title = this.getInfoDict().lookup(PDFName.Title);\n    if (!title) return undefined;\n    assertIsLiteralOrHexString(title);\n    return title.decodeText();\n  }\n\n  /**\n   * Get this document's author metadata. The author appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const author = pdfDoc.getAuthor()\n   * ```\n   * @returns A string containing the author of this document, if it has one.\n   */\n  getAuthor(): string | undefined {\n    const author = this.getInfoDict().lookup(PDFName.Author);\n    if (!author) return undefined;\n    assertIsLiteralOrHexString(author);\n    return author.decodeText();\n  }\n\n  /**\n   * Get this document's subject metadata. The subject appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const subject = pdfDoc.getSubject()\n   * ```\n   * @returns A string containing the subject of this document, if it has one.\n   */\n  getSubject(): string | undefined {\n    const subject = this.getInfoDict().lookup(PDFName.Subject);\n    if (!subject) return undefined;\n    assertIsLiteralOrHexString(subject);\n    return subject.decodeText();\n  }\n\n  /**\n   * Get this document's keywords metadata. The keywords appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const keywords = pdfDoc.getKeywords()\n   * ```\n   * @returns A string containing the keywords of this document, if it has any.\n   */\n  getKeywords(): string | undefined {\n    const keywords = this.getInfoDict().lookup(PDFName.Keywords);\n    if (!keywords) return undefined;\n    assertIsLiteralOrHexString(keywords);\n    return keywords.decodeText();\n  }\n\n  /**\n   * Get this document's creator metadata. The creator appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const creator = pdfDoc.getCreator()\n   * ```\n   * @returns A string containing the creator of this document, if it has one.\n   */\n  getCreator(): string | undefined {\n    const creator = this.getInfoDict().lookup(PDFName.Creator);\n    if (!creator) return undefined;\n    assertIsLiteralOrHexString(creator);\n    return creator.decodeText();\n  }\n\n  /**\n   * Get this document's producer metadata. The producer appears in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const producer = pdfDoc.getProducer()\n   * ```\n   * @returns A string containing the producer of this document, if it has one.\n   */\n  getProducer(): string | undefined {\n    const producer = this.getInfoDict().lookup(PDFName.Producer);\n    if (!producer) return undefined;\n    assertIsLiteralOrHexString(producer);\n    return producer.decodeText();\n  }\n\n  /**\n   * Get this document's creation date metadata. The creation date appears in\n   * the \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * const creationDate = pdfDoc.getCreationDate()\n   * ```\n   * @returns A Date containing the creation date of this document,\n   *          if it has one.\n   */\n  getCreationDate(): Date | undefined {\n    const creationDate = this.getInfoDict().lookup(PDFName.CreationDate);\n    if (!creationDate) return undefined;\n    assertIsLiteralOrHexString(creationDate);\n    return creationDate.decodeDate();\n  }\n\n  /**\n   * Get this document's modification date metadata. The modification date\n   * appears in the \"Document Properties\" section of most PDF readers.\n   * For example:\n   * ```js\n   * const modification = pdfDoc.getModificationDate()\n   * ```\n   * @returns A Date containing the modification date of this document,\n   *          if it has one.\n   */\n  getModificationDate(): Date | undefined {\n    const modificationDate = this.getInfoDict().lookup(PDFName.ModDate);\n    if (!modificationDate) return undefined;\n    assertIsLiteralOrHexString(modificationDate);\n    return modificationDate.decodeDate();\n  }\n\n  /**\n   * Set this document's title metadata. The title will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setTitle('ðŸ¥š The Life of an Egg ðŸ³')\n   * ```\n   *\n   * To display the title in the window's title bar, set the\n   * `showInWindowTitleBar` option to `true` (works for _most_ PDF readers).\n   * For example:\n   * ```js\n   * pdfDoc.setTitle('ðŸ¥š The Life of an Egg ðŸ³', { showInWindowTitleBar: true })\n   * ```\n   *\n   * @param title The title of this document.\n   * @param options The options to be used when setting the title.\n   */\n  setTitle(title: string, options?: SetTitleOptions): void {\n    assertIs(title, 'title', ['string']);\n    const key = PDFName.of('Title');\n    this.getInfoDict().set(key, PDFHexString.fromText(title));\n\n    // Indicate that readers should display the title rather than the filename\n    if (options?.showInWindowTitleBar) {\n      const prefs = this.catalog.getOrCreateViewerPreferences();\n      prefs.setDisplayDocTitle(true);\n    }\n  }\n\n  /**\n   * Set this document's author metadata. The author will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setAuthor('Humpty Dumpty')\n   * ```\n   * @param author The author of this document.\n   */\n  setAuthor(author: string): void {\n    assertIs(author, 'author', ['string']);\n    const key = PDFName.of('Author');\n    this.getInfoDict().set(key, PDFHexString.fromText(author));\n  }\n\n  /**\n   * Set this document's subject metadata. The subject will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setSubject('ðŸ“˜ An Epic Tale of Woe ðŸ“–')\n   * ```\n   * @param subject The subject of this document.\n   */\n  setSubject(subject: string): void {\n    assertIs(subject, 'author', ['string']);\n    const key = PDFName.of('Subject');\n    this.getInfoDict().set(key, PDFHexString.fromText(subject));\n  }\n\n  /**\n   * Set this document's keyword metadata. These keywords will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setKeywords(['eggs', 'wall', 'fall', 'king', 'horses', 'men'])\n   * ```\n   * @param keywords An array of keywords associated with this document.\n   */\n  setKeywords(keywords: string[]): void {\n    assertIs(keywords, 'keywords', [Array]);\n    const key = PDFName.of('Keywords');\n    this.getInfoDict().set(key, PDFHexString.fromText(keywords.join(' ')));\n  }\n\n  /**\n   * Set this document's creator metadata. The creator will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setCreator('PDF App 9000 ðŸ¤–')\n   * ```\n   * @param creator The creator of this document.\n   */\n  setCreator(creator: string): void {\n    assertIs(creator, 'creator', ['string']);\n    const key = PDFName.of('Creator');\n    this.getInfoDict().set(key, PDFHexString.fromText(creator));\n  }\n\n  /**\n   * Set this document's producer metadata. The producer will appear in the\n   * \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setProducer('PDF App 9000 ðŸ¤–')\n   * ```\n   * @param producer The producer of this document.\n   */\n  setProducer(producer: string): void {\n    assertIs(producer, 'creator', ['string']);\n    const key = PDFName.of('Producer');\n    this.getInfoDict().set(key, PDFHexString.fromText(producer));\n  }\n\n  /**\n   * Set this document's language metadata. The language will appear in the\n   * \"Document Properties\" section of some PDF readers. For example:\n   * ```js\n   * pdfDoc.setLanguage('en-us')\n   * ```\n   *\n   * @param language An RFC 3066 _Language-Tag_ denoting the language of this\n   *                 document, or an empty string if the language is unknown.\n   */\n  setLanguage(language: string): void {\n    assertIs(language, 'language', ['string']);\n    const key = PDFName.of('Lang');\n    this.catalog.set(key, PDFString.of(language));\n  }\n\n  /**\n   * Set this document's creation date metadata. The creation date will appear\n   * in the \"Document Properties\" section of most PDF readers. For example:\n   * ```js\n   * pdfDoc.setCreationDate(new Date())\n   * ```\n   * @param creationDate The date this document was created.\n   */\n  setCreationDate(creationDate: Date): void {\n    assertIs(creationDate, 'creationDate', [[Date, 'Date']]);\n    const key = PDFName.of('CreationDate');\n    this.getInfoDict().set(key, PDFString.fromDate(creationDate));\n  }\n\n  /**\n   * Set this document's modification date metadata. The modification date will\n   * appear in the \"Document Properties\" section of most PDF readers. For\n   * example:\n   * ```js\n   * pdfDoc.setModificationDate(new Date())\n   * ```\n   * @param modificationDate The date this document was last modified.\n   */\n  setModificationDate(modificationDate: Date): void {\n    assertIs(modificationDate, 'modificationDate', [[Date, 'Date']]);\n    const key = PDFName.of('ModDate');\n    this.getInfoDict().set(key, PDFString.fromDate(modificationDate));\n  }\n\n  /**\n   * Get the number of pages contained in this document. For example:\n   * ```js\n   * const totalPages = pdfDoc.getPageCount()\n   * ```\n   * @returns The number of pages in this document.\n   */\n  getPageCount(): number {\n    if (this.pageCount === undefined) this.pageCount = this.getPages().length;\n    return this.pageCount;\n  }\n\n  /**\n   * Get an array of all the pages contained in this document. The pages are\n   * stored in the array in the same order that they are rendered in the\n   * document. For example:\n   * ```js\n   * const pages = pdfDoc.getPages()\n   * pages[0]   // The first page of the document\n   * pages[2]   // The third page of the document\n   * pages[197] // The 198th page of the document\n   * ```\n   * @returns An array of all the pages contained in this document.\n   */\n  getPages(): PDFPage[] {\n    return this.pageCache.access();\n  }\n\n  /**\n   * Get the page rendered at a particular `index` of the document. For example:\n   * ```js\n   * pdfDoc.getPage(0)   // The first page of the document\n   * pdfDoc.getPage(2)   // The third page of the document\n   * pdfDoc.getPage(197) // The 198th page of the document\n   * ```\n   * @returns The [[PDFPage]] rendered at the given `index` of the document.\n   */\n  getPage(index: number): PDFPage {\n    const pages = this.getPages();\n    assertRange(index, 'index', 0, pages.length - 1);\n    return pages[index];\n  }\n\n  /**\n   * Get an array of indices for all the pages contained in this document. The\n   * array will contain a range of integers from\n   * `0..pdfDoc.getPageCount() - 1`. For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   * pdfDoc.addPage()\n   * pdfDoc.addPage()\n   * pdfDoc.addPage()\n   *\n   * const indices = pdfDoc.getPageIndices()\n   * indices // => [0, 1, 2]\n   * ```\n   * @returns An array of indices for all pages contained in this document.\n   */\n  getPageIndices(): number[] {\n    return range(0, this.getPageCount());\n  }\n\n  /**\n   * Remove the page at a given index from this document. For example:\n   * ```js\n   * pdfDoc.removePage(0)   // Remove the first page of the document\n   * pdfDoc.removePage(2)   // Remove the third page of the document\n   * pdfDoc.removePage(197) // Remove the 198th page of the document\n   * ```\n   * Once a page has been removed, it will no longer be rendered at that index\n   * in the document.\n   * @param index The index of the page to be removed.\n   */\n  removePage(index: number): void {\n    const pageCount = this.getPageCount();\n    if (this.pageCount === 0) throw new RemovePageFromEmptyDocumentError();\n    assertRange(index, 'index', 0, pageCount - 1);\n    this.catalog.removeLeafNode(index);\n    this.pageCount = pageCount - 1;\n  }\n\n  /**\n   * Add a page to the end of this document. This method accepts three\n   * different value types for the `page` parameter:\n   *\n   * | Type               | Behavior                                                                            |\n   * | ------------------ | ----------------------------------------------------------------------------------- |\n   * | `undefined`        | Create a new page and add it to the end of this document                            |\n   * | `[number, number]` | Create a new page with the given dimensions and add it to the end of this document  |\n   * | `PDFPage`          | Add the existing page to the end of this document                                   |\n   *\n   * For example:\n   * ```js\n   * // page=undefined\n   * const newPage = pdfDoc.addPage()\n   *\n   * // page=[number, number]\n   * import { PageSizes } from 'pdf-lib'\n   * const newPage1 = pdfDoc.addPage(PageSizes.A7)\n   * const newPage2 = pdfDoc.addPage(PageSizes.Letter)\n   * const newPage3 = pdfDoc.addPage([500, 750])\n   *\n   * // page=PDFPage\n   * const pdfDoc1 = await PDFDocument.create()\n   * const pdfDoc2 = await PDFDocument.load(...)\n   * const [existingPage] = await pdfDoc1.copyPages(pdfDoc2, [0])\n   * pdfDoc1.addPage(existingPage)\n   * ```\n   *\n   * @param page Optionally, the desired dimensions or existing page.\n   * @returns The newly created (or existing) page.\n   */\n  addPage(page?: PDFPage | [number, number]): PDFPage {\n    assertIs(page, 'page', ['undefined', [PDFPage, 'PDFPage'], Array]);\n    return this.insertPage(this.getPageCount(), page);\n  }\n\n  /**\n   * Insert a page at a given index within this document. This method accepts\n   * three different value types for the `page` parameter:\n   *\n   * | Type               | Behavior                                                                       |\n   * | ------------------ | ------------------------------------------------------------------------------ |\n   * | `undefined`        | Create a new page and insert it into this document                             |\n   * | `[number, number]` | Create a new page with the given dimensions and insert it into this document   |\n   * | `PDFPage`          | Insert the existing page into this document                                    |\n   *\n   * For example:\n   * ```js\n   * // page=undefined\n   * const newPage = pdfDoc.insertPage(2)\n   *\n   * // page=[number, number]\n   * import { PageSizes } from 'pdf-lib'\n   * const newPage1 = pdfDoc.insertPage(2, PageSizes.A7)\n   * const newPage2 = pdfDoc.insertPage(0, PageSizes.Letter)\n   * const newPage3 = pdfDoc.insertPage(198, [500, 750])\n   *\n   * // page=PDFPage\n   * const pdfDoc1 = await PDFDocument.create()\n   * const pdfDoc2 = await PDFDocument.load(...)\n   * const [existingPage] = await pdfDoc1.copyPages(pdfDoc2, [0])\n   * pdfDoc1.insertPage(0, existingPage)\n   * ```\n   *\n   * @param index The index at which the page should be inserted (zero-based).\n   * @param page Optionally, the desired dimensions or existing page.\n   * @returns The newly created (or existing) page.\n   */\n  insertPage(index: number, page?: PDFPage | [number, number]): PDFPage {\n    const pageCount = this.getPageCount();\n    assertRange(index, 'index', 0, pageCount);\n    assertIs(page, 'page', ['undefined', [PDFPage, 'PDFPage'], Array]);\n    if (!page || Array.isArray(page)) {\n      const dims = Array.isArray(page) ? page : PageSizes.A4;\n      page = PDFPage.create(this);\n      page.setSize(...dims);\n    } else if (page.doc !== this) {\n      throw new ForeignPageError();\n    }\n\n    const parentRef = this.catalog.insertLeafNode(page.ref, index);\n    page.node.setParent(parentRef);\n\n    this.pageMap.set(page.node, page);\n    this.pageCache.invalidate();\n\n    this.pageCount = pageCount + 1;\n\n    return page;\n  }\n\n  /**\n   * Copy pages from a source document into this document. Allows pages to be\n   * copied between different [[PDFDocument]] instances. For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   * const srcDoc = await PDFDocument.load(...)\n   *\n   * const copiedPages = await pdfDoc.copyPages(srcDoc, [0, 3, 89])\n   * const [firstPage, fourthPage, ninetiethPage] = copiedPages;\n   *\n   * pdfDoc.addPage(fourthPage)\n   * pdfDoc.insertPage(0, ninetiethPage)\n   * pdfDoc.addPage(firstPage)\n   * ```\n   * @param srcDoc The document from which pages should be copied.\n   * @param indices The indices of the pages that should be copied.\n   * @returns Resolves with an array of pages copied into this document.\n   */\n  async copyPages(srcDoc: PDFDocument, indices: number[]): Promise<PDFPage[]> {\n    assertIs(srcDoc, 'srcDoc', [[PDFDocument, 'PDFDocument']]);\n    assertIs(indices, 'indices', [Array]);\n    await srcDoc.flush();\n    const copier = PDFObjectCopier.for(srcDoc.context, this.context);\n    const srcPages = srcDoc.getPages();\n    const copiedPages: PDFPage[] = new Array(indices.length);\n    for (let idx = 0, len = indices.length; idx < len; idx++) {\n      const srcPage = srcPages[indices[idx]];\n      const copiedPage = copier.copy(srcPage.node);\n      const ref = this.context.register(copiedPage);\n      copiedPages[idx] = PDFPage.of(copiedPage, ref, this);\n    }\n    return copiedPages;\n  }\n\n  /**\n   * Get a copy of this document.\n   *\n   * For example:\n   * ```js\n   * const srcDoc = await PDFDocument.load(...)\n   * const pdfDoc = await srcDoc.copy()\n   * ```\n   *\n   * > **NOTE:**  This method won't copy all information over to the new\n   * > document (acroforms, outlines, etc...).\n   *\n   * @returns Resolves with a copy this document.\n   */\n  async copy(): Promise<PDFDocument> {\n    const pdfCopy = await PDFDocument.create();\n    const contentPages = await pdfCopy.copyPages(this, this.getPageIndices());\n\n    for (let idx = 0, len = contentPages.length; idx < len; idx++) {\n      pdfCopy.addPage(contentPages[idx]);\n    }\n\n    if (this.getAuthor() !== undefined) {\n      pdfCopy.setAuthor(this.getAuthor()!);\n    }\n    if (this.getCreationDate() !== undefined) {\n      pdfCopy.setCreationDate(this.getCreationDate()!);\n    }\n    if (this.getCreator() !== undefined) {\n      pdfCopy.setCreator(this.getCreator()!);\n    }\n    if (this.getModificationDate() !== undefined) {\n      pdfCopy.setModificationDate(this.getModificationDate()!);\n    }\n    if (this.getProducer() !== undefined) {\n      pdfCopy.setProducer(this.getProducer()!);\n    }\n    if (this.getSubject() !== undefined) {\n      pdfCopy.setSubject(this.getSubject()!);\n    }\n    if (this.getTitle() !== undefined) {\n      pdfCopy.setTitle(this.getTitle()!);\n    }\n    pdfCopy.defaultWordBreaks = this.defaultWordBreaks;\n\n    return pdfCopy;\n  }\n\n  /**\n   * Add JavaScript to this document. The supplied `script` is executed when the\n   * document is opened. The `script` can be used to perform some operation\n   * when the document is opened (e.g. logging to the console), or it can be\n   * used to define a function that can be referenced later in a JavaScript\n   * action. For example:\n   * ```js\n   * // Show \"Hello World!\" in the console when the PDF is opened\n   * pdfDoc.addJavaScript(\n   *   'main',\n   *   'console.show(); console.println(\"Hello World!\");'\n   * );\n   *\n   * // Define a function named \"foo\" that can be called in JavaScript Actions\n   * pdfDoc.addJavaScript(\n   *   'foo',\n   *   'function foo() { return \"foo\"; }'\n   * );\n   * ```\n   * See the [JavaScript for Acrobat API Reference](https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/js_api_reference.pdf)\n   * for details.\n   * @param name The name of the script. Must be unique per document.\n   * @param script The JavaScript to execute.\n   */\n  addJavaScript(name: string, script: string) {\n    assertIs(name, 'name', ['string']);\n    assertIs(script, 'script', ['string']);\n\n    const embedder = JavaScriptEmbedder.for(script, name);\n\n    const ref = this.context.nextRef();\n    const javaScript = PDFJavaScript.of(ref, this, embedder);\n    this.javaScripts.push(javaScript);\n  }\n\n  /**\n   * Add an attachment to this document. Attachments are visible in the\n   * \"Attachments\" panel of Adobe Acrobat and some other PDF readers. Any\n   * type of file can be added as an attachment. This includes, but is not\n   * limited to, `.png`, `.jpg`, `.pdf`, `.csv`, `.docx`, and `.xlsx` files.\n   *\n   * The input data can be provided in multiple formats:\n   *\n   * | Type          | Contents                                                       |\n   * | ------------- | -------------------------------------------------------------- |\n   * | `string`      | A base64 encoded string (or data URI) containing an attachment |\n   * | `Uint8Array`  | The raw bytes of an attachment                                 |\n   * | `ArrayBuffer` | The raw bytes of an attachment                                 |\n   *\n   * For example:\n   * ```js\n   * // attachment=string\n   * await pdfDoc.attach('/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD...', 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   * await pdfDoc.attach('data:image/jpeg;base64,/9j/4AAQ...', 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   *\n   * // attachment=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('cat_riding_unicorn.jpg')\n   * await pdfDoc.attach(uint8Array, 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   *\n   * // attachment=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * await pdfDoc.attach(arrayBuffer, 'cat_riding_unicorn.jpg', {\n   *   mimeType: 'image/jpeg',\n   *   description: 'Cool cat riding a unicorn! ðŸ¦„ðŸˆðŸ•¶ï¸',\n   *   creationDate: new Date('2019/12/01'),\n   *   modificationDate: new Date('2020/04/19'),\n   * })\n   * ```\n   *\n   * @param attachment The input data containing the file to be attached.\n   * @param name The name of the file to be attached.\n   * @returns Resolves when the attachment is complete.\n   */\n  async attach(\n    attachment: string | Uint8Array | ArrayBuffer,\n    name: string,\n    options: AttachmentOptions = {},\n  ): Promise<void> {\n    assertIs(attachment, 'attachment', ['string', Uint8Array, ArrayBuffer]);\n    assertIs(name, 'name', ['string']);\n    assertOrUndefined(options.mimeType, 'mimeType', ['string']);\n    assertOrUndefined(options.description, 'description', ['string']);\n    assertOrUndefined(options.creationDate, 'options.creationDate', [Date]);\n    assertOrUndefined(options.modificationDate, 'options.modificationDate', [\n      Date,\n    ]);\n    assertIsOneOfOrUndefined(\n      options.afRelationship,\n      'options.afRelationship',\n      AFRelationship,\n    );\n\n    const bytes = toUint8Array(attachment);\n    const embedder = FileEmbedder.for(bytes, name, options);\n\n    const ref = this.context.nextRef();\n    const embeddedFile = PDFEmbeddedFile.of(ref, this, embedder);\n    this.embeddedFiles.push(embeddedFile);\n  }\n\n  /**\n   * Embed a font into this document. The input data can be provided in multiple\n   * formats:\n   *\n   * | Type            | Contents                                                |\n   * | --------------- | ------------------------------------------------------- |\n   * | `StandardFonts` | One of the standard 14 fonts                            |\n   * | `string`        | A base64 encoded string (or data URI) containing a font |\n   * | `Uint8Array`    | The raw bytes of a font                                 |\n   * | `ArrayBuffer`   | The raw bytes of a font                                 |\n   *\n   * For example:\n   * ```js\n   * // font=StandardFonts\n   * import { StandardFonts } from 'pdf-lib'\n   * const font1 = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   *\n   * // font=string\n   * const font2 = await pdfDoc.embedFont('AAEAAAAVAQAABABQRFNJRx/upe...')\n   * const font3 = await pdfDoc.embedFont('data:font/opentype;base64,AAEAAA...')\n   *\n   * // font=Uint8Array\n   * import fs from 'fs'\n   * const font4 = await pdfDoc.embedFont(fs.readFileSync('Ubuntu-R.ttf'))\n   *\n   * // font=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/ubuntu/Ubuntu-R.ttf'\n   * const ubuntuBytes = await fetch(url).then(res => res.arrayBuffer())\n   * const font5 = await pdfDoc.embedFont(ubuntuBytes)\n   * ```\n   * See also: [[registerFontkit]]\n   * @param font The input data for a font.\n   * @param options The options to be used when embedding the font.\n   * @returns Resolves with the embedded font.\n   */\n  async embedFont(\n    font: StandardFonts | string | Uint8Array | ArrayBuffer,\n    options: EmbedFontOptions = {},\n  ): Promise<PDFFont> {\n    const { subset = false, customName, features } = options;\n\n    assertIs(font, 'font', ['string', Uint8Array, ArrayBuffer]);\n    assertIs(subset, 'subset', ['boolean']);\n\n    let embedder: CustomFontEmbedder | StandardFontEmbedder;\n    if (isStandardFont(font)) {\n      embedder = StandardFontEmbedder.for(font, customName);\n    } else if (canBeConvertedToUint8Array(font)) {\n      const bytes = toUint8Array(font);\n      const fontkit = this.assertFontkit();\n      embedder = subset\n        ? await CustomFontSubsetEmbedder.for(\n            fontkit,\n            bytes,\n            customName,\n            features,\n          )\n        : await CustomFontEmbedder.for(fontkit, bytes, customName, features);\n    } else {\n      throw new TypeError(\n        '`font` must be one of `StandardFonts | string | Uint8Array | ArrayBuffer`',\n      );\n    }\n\n    const ref = this.context.nextRef();\n    const pdfFont = PDFFont.of(ref, this, embedder);\n    this.fonts.push(pdfFont);\n\n    return pdfFont;\n  }\n\n  /**\n   * Embed a standard font into this document.\n   * For example:\n   * ```js\n   * import { StandardFonts } from 'pdf-lib'\n   * const helveticaFont = pdfDoc.embedFont(StandardFonts.Helvetica)\n   * ```\n   * @param font The standard font to be embedded.\n   * @param customName The name to be used when embedding the font.\n   * @returns The embedded font.\n   */\n  embedStandardFont(font: StandardFonts, customName?: string): PDFFont {\n    assertIs(font, 'font', ['string']);\n    if (!isStandardFont(font)) {\n      throw new TypeError('`font` must be one of type `StandardFonts`');\n    }\n\n    const embedder = StandardFontEmbedder.for(font, customName);\n\n    const ref = this.context.nextRef();\n    const pdfFont = PDFFont.of(ref, this, embedder);\n    this.fonts.push(pdfFont);\n\n    return pdfFont;\n  }\n\n  /**\n   * Embed a JPEG image into this document. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                                      |\n   * | ------------- | ------------------------------------------------------------- |\n   * | `string`      | A base64 encoded string (or data URI) containing a JPEG image |\n   * | `Uint8Array`  | The raw bytes of a JPEG image                                 |\n   * | `ArrayBuffer` | The raw bytes of a JPEG image                                 |\n   *\n   * For example:\n   * ```js\n   * // jpg=string\n   * const image1 = await pdfDoc.embedJpg('/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD...')\n   * const image2 = await pdfDoc.embedJpg('data:image/jpeg;base64,/9j/4AAQ...')\n   *\n   * // jpg=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('cat_riding_unicorn.jpg')\n   * const image3 = await pdfDoc.embedJpg(uint8Array)\n   *\n   * // jpg=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/cat_riding_unicorn.jpg'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const image4 = await pdfDoc.embedJpg(arrayBuffer)\n   * ```\n   *\n   * @param jpg The input data for a JPEG image.\n   * @returns Resolves with the embedded image.\n   */\n  async embedJpg(jpg: string | Uint8Array | ArrayBuffer): Promise<PDFImage> {\n    assertIs(jpg, 'jpg', ['string', Uint8Array, ArrayBuffer]);\n    const bytes = toUint8Array(jpg);\n    const embedder = await JpegEmbedder.for(bytes);\n    const ref = this.context.nextRef();\n    const pdfImage = PDFImage.of(ref, this, embedder);\n    this.images.push(pdfImage);\n    return pdfImage;\n  }\n\n  /**\n   * Embed a PNG image into this document. The input data can be provided in\n   * multiple formats:\n   *\n   * | Type          | Contents                                                     |\n   * | ------------- | ------------------------------------------------------------ |\n   * | `string`      | A base64 encoded string (or data URI) containing a PNG image |\n   * | `Uint8Array`  | The raw bytes of a PNG image                                 |\n   * | `ArrayBuffer` | The raw bytes of a PNG image                                 |\n   *\n   * For example:\n   * ```js\n   * // png=string\n   * const image1 = await pdfDoc.embedPng('iVBORw0KGgoAAAANSUhEUgAAAlgAAAF3...')\n   * const image2 = await pdfDoc.embedPng('data:image/png;base64,iVBORw0KGg...')\n   *\n   * // png=Uint8Array\n   * import fs from 'fs'\n   * const uint8Array = fs.readFileSync('small_mario.png')\n   * const image3 = await pdfDoc.embedPng(uint8Array)\n   *\n   * // png=ArrayBuffer\n   * const url = 'https://pdf-lib.js.org/assets/small_mario.png'\n   * const arrayBuffer = await fetch(url).then(res => res.arrayBuffer())\n   * const image4 = await pdfDoc.embedPng(arrayBuffer)\n   * ```\n   *\n   * @param png The input data for a PNG image.\n   * @returns Resolves with the embedded image.\n   */\n  async embedPng(png: string | Uint8Array | ArrayBuffer): Promise<PDFImage> {\n    assertIs(png, 'png', ['string', Uint8Array, ArrayBuffer]);\n    const bytes = toUint8Array(png);\n    const embedder = await PngEmbedder.for(bytes);\n    const ref = this.context.nextRef();\n    const pdfImage = PDFImage.of(ref, this, embedder);\n    this.images.push(pdfImage);\n    return pdfImage;\n  }\n\n  /**\n   * Embed one or more PDF pages into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourcePdf = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   *\n   * // Embed page 74 of `sourcePdf` into `pdfDoc`\n   * const [embeddedPage] = await pdfDoc.embedPdf(sourcePdf, [73])\n   * ```\n   *\n   * See [[PDFDocument.load]] for examples of the allowed input data formats.\n   *\n   * @param pdf The input data containing a PDF document.\n   * @param indices The indices of the pages that should be embedded.\n   * @returns Resolves with an array of the embedded pages.\n   */\n  async embedPdf(\n    pdf: string | Uint8Array | ArrayBuffer | PDFDocument,\n    indices: number[] = [0],\n  ): Promise<PDFEmbeddedPage[]> {\n    assertIs(pdf, 'pdf', [\n      'string',\n      Uint8Array,\n      ArrayBuffer,\n      [PDFDocument, 'PDFDocument'],\n    ]);\n    assertIs(indices, 'indices', [Array]);\n\n    const srcDoc =\n      pdf instanceof PDFDocument ? pdf : await PDFDocument.load(pdf);\n\n    const srcPages = pluckIndices(srcDoc.getPages(), indices);\n\n    return this.embedPages(srcPages);\n  }\n\n  /**\n   * Embed a single PDF page into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourceBuffer = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   * const sourcePdfDoc = await PDFDocument.load(sourceBuffer)\n   * const sourcePdfPage = sourcePdfDoc.getPages()[73]\n   *\n   * const embeddedPage = await pdfDoc.embedPage(\n   *   sourcePdfPage,\n   *\n   *   // Clip a section of the source page so that we only embed part of it\n   *   { left: 100, right: 450, bottom: 330, top: 570 },\n   *\n   *   // Translate all drawings of the embedded page by (10, 200) units\n   *   [1, 0, 0, 1, 10, 200],\n   * )\n   * ```\n   *\n   * @param page The page to be embedded.\n   * @param boundingBox\n   * Optionally, an area of the source page that should be embedded\n   * (defaults to entire page).\n   * @param transformationMatrix\n   * Optionally, a transformation matrix that is always applied to the embedded\n   * page anywhere it is drawn.\n   * @returns Resolves with the embedded pdf page.\n   */\n  async embedPage(\n    page: PDFPage,\n    boundingBox?: PageBoundingBox,\n    transformationMatrix?: TransformationMatrix,\n  ): Promise<PDFEmbeddedPage> {\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    const [embeddedPage] = await this.embedPages(\n      [page],\n      [boundingBox],\n      [transformationMatrix],\n    );\n    return embeddedPage;\n  }\n\n  /**\n   * Embed one or more PDF pages into this document.\n   *\n   * For example:\n   * ```js\n   * const pdfDoc = await PDFDocument.create()\n   *\n   * const sourcePdfUrl = 'https://pdf-lib.js.org/assets/with_large_page_count.pdf'\n   * const sourceBuffer = await fetch(sourcePdfUrl).then((res) => res.arrayBuffer())\n   * const sourcePdfDoc = await PDFDocument.load(sourceBuffer)\n   *\n   * const page1 = sourcePdfDoc.getPages()[0]\n   * const page2 = sourcePdfDoc.getPages()[52]\n   * const page3 = sourcePdfDoc.getPages()[73]\n   *\n   * const embeddedPages = await pdfDoc.embedPages([page1, page2, page3])\n   * ```\n   *\n   * @param page\n   * The pages to be embedded (they must all share the same context).\n   * @param boundingBoxes\n   * Optionally, an array of clipping boundaries - one for each page\n   * (defaults to entirety of each page).\n   * @param transformationMatrices\n   * Optionally, an array of transformation matrices - one for each page\n   * (each page's transformation will apply anywhere it is drawn).\n   * @returns Resolves with an array of the embedded pdf pages.\n   */\n  async embedPages(\n    pages: PDFPage[],\n    boundingBoxes: (PageBoundingBox | undefined)[] = [],\n    transformationMatrices: (TransformationMatrix | undefined)[] = [],\n  ) {\n    if (pages.length === 0) return [];\n\n    // Assert all pages have the same context\n    for (let idx = 0, len = pages.length - 1; idx < len; idx++) {\n      const currPage = pages[idx];\n      const nextPage = pages[idx + 1];\n      if (currPage.node.context !== nextPage.node.context) {\n        throw new PageEmbeddingMismatchedContextError();\n      }\n    }\n\n    const context = pages[0].node.context;\n    const maybeCopyPage =\n      context === this.context\n        ? (p: PDFPageLeaf) => p\n        : PDFObjectCopier.for(context, this.context).copy;\n\n    const embeddedPages = new Array<PDFEmbeddedPage>(pages.length);\n    for (let idx = 0, len = pages.length; idx < len; idx++) {\n      const page = maybeCopyPage(pages[idx].node);\n      const box = boundingBoxes[idx];\n      const matrix = transformationMatrices[idx];\n\n      const embedder = await PDFPageEmbedder.for(page, box, matrix);\n\n      const ref = this.context.nextRef();\n      embeddedPages[idx] = PDFEmbeddedPage.of(ref, this, embedder);\n    }\n\n    this.embeddedPages.push(...embeddedPages);\n\n    return embeddedPages;\n  }\n\n  /**\n   * > **NOTE:** You shouldn't need to call this method directly. The [[save]]\n   * > and [[saveAsBase64]] methods will automatically ensure that all embedded\n   * > assets are flushed before serializing the document.\n   *\n   * Flush all embedded fonts, PDF pages, and images to this document's\n   * [[context]].\n   *\n   * @returns Resolves when the flush is complete.\n   */\n  async flush(): Promise<void> {\n    await this.embedAll(this.fonts);\n    await this.embedAll(this.images);\n    await this.embedAll(this.embeddedPages);\n    await this.embedAll(this.embeddedFiles);\n    await this.embedAll(this.javaScripts);\n  }\n\n  /**\n   * Serialize this document to an array of bytes making up a PDF file.\n   * For example:\n   * ```js\n   * const pdfBytes = await pdfDoc.save()\n   * ```\n   *\n   * There are a number of things you can do with the serialized document,\n   * depending on the JavaScript environment you're running in:\n   * * Write it to a file in Node or React Native\n   * * Download it as a Blob in the browser\n   * * Render it in an `iframe`\n   *\n   * @param options The options to be used when saving the document.\n   * @returns Resolves with the bytes of the serialized document.\n   */\n  async save(options: SaveOptions = {}): Promise<Uint8Array> {\n    const {\n      useObjectStreams = true,\n      addDefaultPage = true,\n      objectsPerTick = 50,\n      updateFieldAppearances = true,\n    } = options;\n\n    assertIs(useObjectStreams, 'useObjectStreams', ['boolean']);\n    assertIs(addDefaultPage, 'addDefaultPage', ['boolean']);\n    assertIs(objectsPerTick, 'objectsPerTick', ['number']);\n    assertIs(updateFieldAppearances, 'updateFieldAppearances', ['boolean']);\n\n    if (addDefaultPage && this.getPageCount() === 0) this.addPage();\n\n    if (updateFieldAppearances) {\n      const form = this.formCache.getValue();\n      if (form) form.updateFieldAppearances();\n    }\n\n    await this.flush();\n\n    const Writer = useObjectStreams ? PDFStreamWriter : PDFWriter;\n    return Writer.forContext(this.context, objectsPerTick).serializeToBuffer();\n  }\n\n  /**\n   * Serialize this document to a base64 encoded string or data URI making up a\n   * PDF file. For example:\n   * ```js\n   * const base64String = await pdfDoc.saveAsBase64()\n   * base64String // => 'JVBERi0xLjcKJYGBgYEKC...'\n   *\n   * const base64DataUri = await pdfDoc.saveAsBase64({ dataUri: true })\n   * base64DataUri // => 'data:application/pdf;base64,JVBERi0xLjcKJYGBgYEKC...'\n   * ```\n   *\n   * @param options The options to be used when saving the document.\n   * @returns Resolves with a base64 encoded string or data URI of the\n   *          serialized document.\n   */\n  async saveAsBase64(options: Base64SaveOptions = {}): Promise<string> {\n    const { dataUri = false, ...otherOptions } = options;\n    assertIs(dataUri, 'dataUri', ['boolean']);\n    const bytes = await this.save(otherOptions);\n    const base64 = encodeToBase64(bytes);\n    return dataUri ? `data:application/pdf;base64,${base64}` : base64;\n  }\n\n  findPageForAnnotationRef(ref: PDFRef): PDFPage | undefined {\n    const pages = this.getPages();\n    for (let idx = 0, len = pages.length; idx < len; idx++) {\n      const page = pages[idx];\n      const annotations = page.node.Annots();\n\n      if (annotations?.indexOf(ref) !== undefined) {\n        return page;\n      }\n    }\n\n    return undefined;\n  }\n\n  private async embedAll(embeddables: Embeddable[]): Promise<void> {\n    for (let idx = 0, len = embeddables.length; idx < len; idx++) {\n      await embeddables[idx].embed();\n    }\n  }\n\n  private updateInfoDict(): void {\n    const pdfLib = `pdf-lib (https://github.com/Hopding/pdf-lib)`;\n    const now = new Date();\n\n    const info = this.getInfoDict();\n\n    this.setProducer(pdfLib);\n    this.setModificationDate(now);\n\n    if (!info.get(PDFName.of('Creator'))) this.setCreator(pdfLib);\n    if (!info.get(PDFName.of('CreationDate'))) this.setCreationDate(now);\n  }\n\n  private getInfoDict(): PDFDict {\n    const existingInfo = this.context.lookup(this.context.trailerInfo.Info);\n    if (existingInfo instanceof PDFDict) return existingInfo;\n\n    const newInfo = this.context.obj({});\n    this.context.trailerInfo.Info = this.context.register(newInfo);\n\n    return newInfo;\n  }\n\n  private assertFontkit(): Fontkit {\n    if (!this.fontkit) throw new FontkitNotRegisteredError();\n    return this.fontkit;\n  }\n\n  private computePages = (): PDFPage[] => {\n    const pages: PDFPage[] = [];\n    this.catalog.Pages().traverse((node, ref) => {\n      if (node instanceof PDFPageLeaf) {\n        let page = this.pageMap.get(node);\n        if (!page) {\n          page = PDFPage.of(node, ref, this);\n          this.pageMap.set(node, page);\n        }\n        pages.push(page);\n      }\n    });\n    return pages;\n  };\n\n  private getOrCreateForm = (): PDFForm => {\n    const acroForm = this.catalog.getOrCreateAcroForm();\n    return PDFForm.of(acroForm, this);\n  };\n}\n\n/* tslint:disable-next-line only-arrow-functions */\nfunction assertIsLiteralOrHexString(\n  pdfObject: PDFObject,\n): asserts pdfObject is PDFHexString | PDFString {\n  if (\n    !(pdfObject instanceof PDFHexString) &&\n    !(pdfObject instanceof PDFString)\n  ) {\n    throw new UnexpectedObjectTypeError([PDFHexString, PDFString], pdfObject);\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}